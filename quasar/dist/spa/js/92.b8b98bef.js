(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[92],{a507:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",[s("page-toolbar",{attrs:{buttons:t.toolbarButtons},on:{complete:function(e){return t.completeFn()},save:function(e){return t.saveFn()},sms:function(e){return t.sms()},generatelabel:function(e){return t.generatelabel()}}}),s("breadcrumbs",{attrs:{breadcrumbs:t.breadcrumbs}}),s("div",{class:t.$q.screen.gt.sm?"q-px-lg q-mt-md":"q-px-xs q-mt-sm"},[s("q-card",[s("div",{staticClass:"row q-col-gutter-md q-pa-md "},[s("div",{staticClass:"col"},[s("q-markup-table",{attrs:{"wrap-cells":"",separator:"cell"}},[s("tbody",[s("tr",[s("td",[t._v("Serial No")]),s("td",[t._v(t._s(t.serial_no))])]),s("tr",[s("td",[t._v("Customer")]),s("td",[t._v(t._s(t.sale_order.customer.name))])]),s("tr",[s("td",[t._v("Source")]),s("td",[t._v(t._s(t.sale_order.source))])]),t.sale_order?s("tr",[s("td",[t._v("Sale order")]),s("td",[s("router-link",{attrs:{to:"/sale_orders/view/"+t.sale_order_id}},[t._v(t._s(t.sale_order.serial_no))])],1)]):t._e(),t.sale_order.cod?s("tr",[s("td",{attrs:{colspan:"2"}},[s("div",{staticClass:"text-center text-subtitle2"},[t._v("COD")])])]):t._e()])])],1),s("div",{staticClass:"col"},[s("q-markup-table",{attrs:{"wrap-cells":"",separator:"cell"}},[s("tbody",[s("tr",[s("td",[t._v("Status")]),s("td",[t._v(t._s(t.status))])]),s("tr",[s("td",[t._v("Created By")]),s("td",[t._v(t._s(t.created_by.name))])]),s("tr",[s("td",[t._v("Representative")]),s("td",[t._v(t._s(t.sale_order.representative.name))])]),s("tr",[s("td",[t._v("Created At")]),s("td",[t._v(t._s(t.getLocaleString(t.created_at)))])]),s("tr",[s("td",[t._v("Order No")]),s("td",[t._v(t._s(t.sale_order.order_no))])])])])],1)]),s("div",{staticClass:"row q-mt-md q-px-md"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-h6"},[t._v("Details")]),s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-subtitle2 q-mt-md"},[t._v("Dimensions & Weight")]),s("div",{staticClass:"row q-col-gutter-md "},[s("div",{staticClass:"col-3"},[s("q-input",{attrs:{label:"L",hint:"in cms",outlined:"",square:"",dense:""},model:{value:t.length,callback:function(e){t.length=e},expression:"length"}})],1),s("div",{staticClass:"col-3"},[s("q-input",{attrs:{label:"W",hint:"in cms",outlined:"",square:"",dense:""},model:{value:t.width,callback:function(e){t.width=e},expression:"width"}})],1),s("div",{staticClass:"col-3"},[s("q-input",{attrs:{label:"H",hint:"in cms",outlined:"",square:"",dense:""},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}})],1),s("div",{staticClass:"col-3"},[s("q-input",{attrs:{filled:"","bg-color":"green-2",label:"Weight",hint:"in grams",outlined:"",square:"",dense:""},model:{value:t.weight,callback:function(e){t.weight=e},expression:"weight"}})],1)])]),s("div",{staticClass:"col"},[s("div",{staticClass:"text-subtitle2 q-mt-md"},[t._v("Tracking")]),s("div",{staticClass:"row q-col-gutter-md q-mb-sm"},[s("div",{staticClass:"col"},[s("q-select",{attrs:{options:t.logisticOptions,label:"Courier",outlined:"",square:"",dense:"","option-value":"id","emit-value":"","map-options":"","option-label":"name"},model:{value:t.courier_id,callback:function(e){t.courier_id=e},expression:"courier_id"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Tracking Number",outlined:"",square:"",dense:""},model:{value:t.tracking_number,callback:function(e){t.tracking_number=e},expression:"tracking_number"}})],1)]),t.courier_id?s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-btn",{attrs:{"no-caps":"",flat:"",label:"View Details"},on:{click:t.openLogisticDetails}})],1)]):t._e()])])])]),s("div",{staticClass:"row q-mt-md q-px-md"},[s("div",{staticClass:"col "},[s("div",{staticClass:"text-subtitle2"},[t._v("Remarks")]),s("q-editor",{model:{value:t.remarks,callback:function(e){t.remarks=e},expression:"remarks"}})],1)])])],1),s("page-toolbar",{staticClass:"q-mt-md",attrs:{"page-title":"",buttons:t.toolbarButtons},on:{complete:function(e){return t.completeFn()},save:function(e){return t.saveFn()},generatelabel:function(e){return t.generatelabel()}}})],1)},i=[],l=(s("e6cf"),s("a79d"),s("5319"),s("ddb0"),s("2b3d"),s("a89c")),r=s("b6c6"),n={name:"SaleOrdersView",components:{PageToolbar:l["a"],Breadcrumbs:r["a"]},data(){return{serial_no:"",sale_order_id:null,customer:{name:null},sale_order:{serial_no:null,source:null,representative:{name:null},customer:{name:null}},created_by:{name:null},created_at:null,status:null,remarks:"",length:null,width:null,height:null,weight:null,courier_id:null,tracking_number:null,logisticOptions:[]}},mounted(){this.$axios.get("logistic_partners").then((t=>{this.logisticOptions=t.data.model})),this.getDataFromApi()},computed:{toolbarButtons(){const t=[];return t.push({label:"Generate Label",id:"generatelabel",type:"button",color:"grey-10",icon:"get_app",flat:!0}),"Complete"===this.status&&t.push({label:"Send SMS",id:"sms",type:"button",color:"blue-10",icon:"forward"}),"Complete"!==this.status&&(t.push({label:"Save",id:"save",type:"button",color:"green",icon:"save"}),(this.$store.getters.hasPermissionTo("update_shipment")&&this.weight&&this.length&&this.width&&this.height||this.sale_order.otc)&&t.push({label:"Ship",id:"complete",type:"button",color:"green-10",icon:"check"})),t},breadcrumbs(){const t=[{label:"Dashboard",link:"/"},{label:"Shipments",link:"/shipments"},{label:this.serial_no}];return t}},methods:{getDataFromApi(){this.$q.loading.show(),this.$axios.get("shipments/"+this.$route.params.id).then((t=>{this.serial_no=t.data.serial_no,this.sale_order_id=t.data.sale_order_id,this.sale_order=t.data.sale_order,this.created_by=t.data.created_by,this.created_at=t.data.created_at,this.status=t.data.status,this.remarks=t.data.remarks?t.data.remarks:"",this.length=t.data.length,this.width=t.data.width,this.height=t.data.height,this.weight=t.data.weight,this.courier_id=t.data.courier_id,this.tracking_number=t.data.tracking_number})).finally((()=>{this.$store.commit("setPageTitle","Shipments: "+this.serial_no),this.$q.loading.hide()}))},completeFn(){const t={length:this.length,width:this.width,height:this.height,weight:this.weight,courier_id:this.courier_id,tracking_number:this.tracking_number,remarks:this.remarks,_method:"PUT"};this.$axios.post("shipments/complete/"+this.$route.params.id,t).then((t=>{"success"===t.data.message&&(this.$q.notify({type:"positive",message:"Data saved successfully"}),this.$router.back())}))},saveFn(){const t={length:this.length,width:this.width,height:this.height,weight:this.weight,courier_id:this.courier_id,tracking_number:this.tracking_number,remarks:this.remarks,_method:"PUT"};this.$axios.post("shipments/"+this.$route.params.id,t).then((t=>{"success"===t.data.message&&(this.$q.notify({type:"positive",message:"Data saved successfully"}),this.$router.back())}))},ship(){this.$q.dialog({title:"Select Shipment Generation Mode",options:{type:"radio",model:"shipment_gen_mode",items:[{label:"Full Shipment",value:"full"},{label:"Split Shipment",value:"split"}]}}).onOk((t=>{"full"===t?this.$axios.get("shipments/ship/"+this.$route.params.id).then((t=>{"success"===t.data.message&&(this.$q.notify({type:"positive",message:"Shipment generated succesfully"}),this.$router.push({path:"/shipments/view/"+t.data.shipment_id}))})):"split"===t&&(this.shipmentSelectionDialog=!0)}))},getLocaleString(t){if(t){const e=new Date(t);return e.toLocaleString("en-IN")}return""},openLogisticDetails(){this.$axios.get("logistic_partners/"+this.courier_id).then((t=>{let e="<ul>";t.data.contacts.forEach((t=>{e+="<li>"+t.name+", "+t.phone+" "+t.designation+"</li>"})),e+="</ul>",this.$q.dialog({title:t.data.name,message:"<p>"+t.data.address+"<br/>"+e,html:!0})}))},generatelabel(){this.$q.loading.show(),this.$axios({url:"shipments/label/"+this.$route.params.id,method:"GET",responseType:"blob"}).then((t=>{const e=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=e,s.setAttribute("download",this.serial_no.replace(/\//g,"")+".pdf"),document.body.appendChild(s),s.click()})).finally((()=>{this.$q.loading.hide()}))},sms(){this.$q.loading.show(),this.$axios.get("shipments/sms/"+this.$route.params.id).then((()=>{this.$q.notify({message:"SMS Sent"})})).finally((()=>this.$q.loading.hide()))}}},o=n,d=s("2877"),c=s("9989"),h=s("f09f"),u=s("2bb1"),m=s("27f9"),p=s("ddd8"),g=s("9c40"),_=s("d66b"),b=s("eebe"),v=s.n(b),w=Object(d["a"])(o,a,i,!1,null,null,null);e["default"]=w.exports;v()(w,"components",{QPage:c["a"],QCard:h["a"],QMarkupTable:u["a"],QInput:m["a"],QSelect:p["a"],QBtn:g["a"],QEditor:_["a"]})}}]);