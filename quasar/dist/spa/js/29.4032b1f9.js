(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[29],{"51bd":function(e,t,l){"use strict";l.r(t);var a=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("q-page",{staticClass:"q-px-lg"},[l("breadcrumbs",{attrs:{breadcrumbs:e.breadcrumbs}}),l("div",{staticClass:"row"},[l("div",{staticClass:"col-12 col-md-3"},[l("q-select",{attrs:{dense:"",outlined:"",options:e.options,label:"Entity"},on:{input:e.getTableData},model:{value:e.entity,callback:function(t){e.entity=t},expression:"entity"}})],1)]),e.columns.length>0?l("div",{staticClass:"row q-mt-md"},[l("div",{staticClass:"col"},[l("div",{staticClass:"text-subtitle2"},[e._v("Select Columns to Import")]),l("q-btn",{attrs:{flat:"",color:"grey-10",label:"Select All"},on:{click:function(t){e.selectedColumns=e.$_.map(e.columns,"value")}}}),l("q-btn",{attrs:{flat:"",color:"grey-10",label:"Deselect All"},on:{click:function(t){e.selectedColumns=[]}}})],1)]):e._e(),e.columns.length>0?l("div",{staticClass:"row"},[l("div",{staticClass:"col"},[l("q-markup-table",[l("thead",[l("th",{staticClass:"text-left"},[e._v("Label")]),l("th",{staticClass:"text-left"},[e._v("Include")]),l("th",[e._v("Filter")])]),l("tbody",e._l(e.columns,(function(t,a){return l("tr",{key:a},[l("td",[e._v(e._s(t.label))]),l("td",[l("q-checkbox",{attrs:{val:t.value},model:{value:e.selectedColumns,callback:function(t){e.selectedColumns=t},expression:"selectedColumns"}})],1),l("td",["string"===t.filterType?l("q-input",{attrs:{filled:"",dense:""},model:{value:e.columns[a].filterBy,callback:function(t){e.$set(e.columns[a],"filterBy",t)},expression:"columns[ind].filterBy"}}):e._e(),"selection"===t.filterType?l("q-select",{attrs:{filled:"",dense:"",options:t.filterOptions,multiple:"","use-chips":""},model:{value:e.columns[a].filterBy,callback:function(t){e.$set(e.columns[a],"filterBy",t)},expression:"columns[ind].filterBy"}}):e._e(),"boolean"===t.filterType?l("q-select",{attrs:{filled:"",dense:"",options:["","Yes","No"]},model:{value:e.columns[a].filterBy,callback:function(t){e.$set(e.columns[a],"filterBy",t)},expression:"columns[ind].filterBy"}}):e._e(),"date_range"===t.filterType?[e._v("\n                "+e._s(t.filterBy.from&&t.filterBy.to?t.filterBy.from+" to "+t.filterBy.to:"")+"\n                "),l("q-btn",{attrs:{icon:"event",flat:"",color:"primary","no-caps":"",label:"Pick Date Range"}},[l("q-popup-proxy",{ref:"qDateProxy",refInFor:!0,attrs:{"transition-show":"scale","transition-hide":"scale"}},[l("q-date",{attrs:{range:"",mask:"YYYY-MM-DD"},model:{value:e.columns[a].filterBy,callback:function(t){e.$set(e.columns[a],"filterBy",t)},expression:"columns[ind].filterBy"}},[l("div",{staticClass:"row items-center justify-end"},[l("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]:e._e()],2)])})),0)])],1)]):e._e(),l("div",{staticClass:"row q-mt-md"},[l("div",{staticClass:"col"},[l("q-btn",{attrs:{unelevated:"",tile:"",color:"primary",label:"Generate",disable:0===e.selectedColumns.length},on:{click:e.exportFn}}),e.download_link?l("q-btn",{staticClass:"q-ml-md",attrs:{unelevated:"",tile:"",color:"green",type:"a",href:e.download_link,target:"_blank",label:"Download"}}):e._e()],1)])],1)},s=[],i=(l("e6cf"),l("a79d"),l("ddb0"),l("b6c6")),n={name:"ExportsIndex",components:{Breadcrumbs:i["a"]},data(){return{selectedColumns:[],download_link:null,entity:null,breadcrumbs:[{label:"Dashboard",link:"/"},{label:"Exports",link:"",disabled:!0}],pagePreferences:{page_index_autosearch:"customers_index_autosearch"},options:["Products","Customers","Customer Sale Summary"],columns:[]}},mounted(){this.$store.commit("setPageTitle","Exports")},methods:{getTableData(){if("Customers"===this.entity){let e=[],t=[],l=[],a=[],s=[];this.$q.loading.show(),Promise.all([this.$axios.get("customers/types").then((t=>{e=t.data})),this.$axios.get("countries").then((e=>{t=e.data})),this.$axios.get("states").then((e=>{l=e.data})),this.$axios.get("districts").then((e=>{a=e.data})),this.$axios.get("representatives").then((e=>{s=e.data.map((e=>e.name))}))]).then((()=>{this.columns=[{label:"Name",value:"name",filterType:"string",filterBy:null},{label:"Type",value:"type",filterType:"selection",filterOptions:e,filterBy:[]},{label:"Billing Address Line 1",value:"address_line_1"},{label:"Billing Address Line 2",value:"address_line_2"},{label:"Billing Address Country",value:"address_country",filterType:"selection",filterOptions:t,filterBy:[]},{label:"Billing Address State",value:"address_state",filterType:"selection",filterOptions:l,filterBy:[]},{label:"Billing Address District",value:"address_district",filterType:"selection",filterOptions:a,filterBy:[]},{label:"Billing Address Pin Code",value:"address_pin"},{label:"Email(s)",value:"emails"},{label:"Phone(s)",value:"phones"},{label:"GST No",value:"gst_number",filterType:"string",filterBy:null},{label:"Representative(s)",value:"representatives",filterType:"selection",filterOptions:s,filterBy:[]},{label:"Status",value:"status",filterType:"selection",filterOptions:["Draft","Pending Approval","Approved","Active","Disabled"],filterBy:[]}]})).finally((()=>this.$q.loading.hide()))}else if("Products"===this.entity){let e=[],t=[],l=[],a=[],s=[];this.$q.loading.show(),Promise.all([this.$axios.get("product_types").then((t=>{e=t.data.model.map((e=>e.name))})),this.$axios.get("product_departments").then((e=>{t=e.data.model.map((e=>e.name))})),this.$axios.get("product_categories").then((e=>{l=e.data.model.map((e=>e.name))})),this.$axios.get("product_sub_categories").then((e=>{a=e.data.model.map((e=>e.name))})),this.$axios.get("product_brands").then((e=>{s=e.data.model.map((e=>e.name))}))]).then((()=>{this.columns=[{label:"Name",value:"name",filterType:"string",filterBy:null},{label:"SKU",value:"sku"},{label:"Status",value:"status",filterType:"selection",filterOptions:["Active","Pending Approval","Approved","Draft"],filterBy:[]},{label:"GST",value:"gst",filterType:"selection",filterOptions:["5","12","18"],filterBy:[]},{label:"MRP",value:"mrp"},{label:"HSN",value:"hsn"},{label:"GTIN",value:"gtin"},{label:"MPN / Reorder Code",value:"mpn"},{label:"weight",value:"weight"},{label:"Length",value:"length"},{label:"Breadth",value:"breadth"},{label:"Height",value:"height"},{label:"Remarks",value:"remarks"},{label:"Type",value:"type",filterType:"selection",filterOptions:e,filterBy:[]},{label:"Department",value:"department",filterType:"selection",filterOptions:t,filterBy:[]},{label:"Category",value:"category",filterType:"selection",filterOptions:l,filterBy:[]},{label:"Sub Category",value:"sub_category",filterType:"selection",filterOptions:a,filterBy:[]},{label:"Brand",value:"brand",filterType:"selection",filterOptions:s,filterBy:[]},{label:"Stock",value:"stock"},{label:"Cost",value:"cost"}]})).finally((()=>this.$q.loading.hide()))}else if("Customer Sale Summary"===this.entity){let e=[];this.$q.loading.show(),Promise.all([this.$axios.get("representatives").then((t=>{e=t.data.map((e=>e.name))}))]).then((()=>{this.columns=[{label:"Customer has GST Number",value:"gst_number",filterType:"boolean",filterBy:null},{label:"Invoiced At",value:"invoiced_at",filterType:"date_range",filterBy:{from:null,to:null}},{label:"Source",value:"source",filterType:"selection",filterOptions:["","Apexion","Dentodeal"],filterBy:[]},{label:"Item count",value:"item_count"},{label:"Representative(s)",value:"representatives",filterType:"selection",filterOptions:e,filterBy:[]}]})).finally((()=>this.$q.loading.hide()))}else this.columns=[]},exportFn(){const e={};this.columns.forEach((t=>{"boolean"===t.filterType||"string"===t.filterType?t.filterBy&&this.selectedColumns.includes(t.value)&&(e[t.value]=t.filterBy):"selection"===t.filterType?t.filterBy.length>0&&this.selectedColumns.includes(t.value)&&(e[t.value]=t.filterBy):"date_range"===t.filterType&&t.filterBy.from&&t.filterBy.to&&(e[t.value]=t.filterBy)})),this.$q.loading.show(),this.$axios({url:"export",method:"POST",data:{entity:this.entity,selected_columns:this.selectedColumns,filters:e}}).then((e=>{this.download_link=this.$axios.defaults.authURL+e.data})).finally((()=>{this.$q.loading.hide()}))}}},o=n,r=l("2877"),c=l("9989"),d=l("ddd8"),u=l("9c40"),p=l("8f8e"),f=l("2bb1"),m=l("27f9"),y=l("7cbe"),b=l("52ee"),h=l("7f67"),v=l("eebe"),g=l.n(v),B=Object(r["a"])(o,a,s,!1,null,null,null);t["default"]=B.exports;g()(B,"components",{QPage:c["a"],QSelect:d["a"],QBtn:u["a"],QCheckbox:p["a"],QMarkupTable:f["a"],QInput:m["a"],QPopupProxy:y["a"],QDate:b["a"]}),g()(B,"directives",{ClosePopup:h["a"]})}}]);