(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{f6f2:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",[s("page-toolbar",{attrs:{buttons:t.toolbarButtons},on:{save:function(e){return t.saveFn()}}}),s("breadcrumbs",{attrs:{breadcrumbs:t.breadcrumbs}}),s("div",{class:t.$q.screen.gt.sm?"q-px-lg":"q-px-xs"},[s("q-card",[s("q-card-section",[s("div",{staticClass:"row q-mt-sm"},[s("div",{staticClass:"col-12 col-md-3"},[s("q-input",{attrs:{outlined:"",dense:"",square:"",label:"Name","error-message":t.errors.name,error:t.errors.name&&t.errors.name.length>0},on:{input:function(e){t.errors.name=null}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1)])])],1)],1),s("div",{class:t.$q.screen.gt.sm?"q-px-lg q-mt-md":"q-px-xs q-mt-sm"},[s("q-card",[s("q-tabs",{staticClass:"text-grey",attrs:{dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("q-tab",{attrs:{name:"permissions",label:"Permissions"}}),s("q-tab",{attrs:{name:"notifications",label:"Notification Subscriptions"}})],1),s("q-separator"),s("q-tab-panels",{attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[s("q-tab-panel",{attrs:{name:"permissions"}},[s("q-card-section",[s("div",{staticClass:"row q-mt-sm"},[s("div",{staticClass:"col-12"},[s("q-btn",{attrs:{label:"Select All",tile:"",dark:"",color:"primary"},on:{click:function(e){return t.selectAll()}}}),s("q-btn",{staticClass:"q-ml-md",attrs:{label:"Reset",tile:"",dark:"",color:"secondary"},on:{click:function(e){return t.resetFn()}}})],1)]),t._l(t.$_.groupBy(t.permissionsCollection,"model"),(function(e,a){return[s("div",{key:a,staticClass:"row q-mt-sm q-col-gutter-md"},[s("div",{staticClass:"col-12"},[s("div",{staticClass:"text-h5"},[t._v(t._s(a))])]),t._l(e,(function(e,a){return s("div",{key:a},[s("q-checkbox",{attrs:{label:e.name,val:e.id},model:{value:t.permissions,callback:function(e){t.permissions=e},expression:"permissions"}})],1)}))],2),s("q-separator",{key:"a"+a,staticClass:"q-mt-md"})]}))],2)],1),s("q-tab-panel",{attrs:{name:"notifications"}},[s("q-card-section",[s("div",{staticClass:"row q-mt-sm"},[s("div",{staticClass:"col-12"},[s("q-btn",{attrs:{label:"Select All",tile:"",dark:"",color:"primary"},on:{click:function(e){return t.selectAllNotifications()}}}),s("q-btn",{staticClass:"q-ml-md",attrs:{label:"Reset",tile:"",dark:"",color:"secondary"},on:{click:function(e){return t.resetNotifications()}}})],1)]),s("q-markup-table",[s("thead",[s("th"),s("th",{staticClass:"text-left"},[t._v("Name")]),s("th",{staticClass:"text-left"},[t._v("Description")])]),s("tbody",t._l(t.notificationCollection,(function(e,a){return s("q-tr",{key:a},[s("q-td",[s("q-checkbox",{attrs:{val:e.id},model:{value:t.notification_types,callback:function(e){t.notification_types=e},expression:"notification_types"}})],1),s("q-td",[t._v(t._s(e.name))]),s("q-td",[t._v(t._s(e.description))])],1)})),1)])],1)],1)],1)],1)],1)],1)},i=[],o=(s("e6cf"),s("a79d"),s("ddb0"),s("a89c")),r=s("b6c6"),n={name:"UserRolesCreate",components:{Breadcrumbs:r["a"],PageToolbar:o["a"]},mounted(){this.$store.getters.hasPermissionTo("create_user_role")?(Promise.all([this.$axios.get("all-permissions").then((t=>{this.permissionsCollection=t.data})),this.$axios.get("notification_types").then((t=>{this.notificationCollection=t.data}))]),this.$route.params.id?this.$axios.get("user_roles/"+this.$route.params.id).then((t=>{this.name=t.data.name,this.permissions=Object.keys(this.$_.groupBy(t.data.permissions,"id")).map(Number),this.notification_types=Object.keys(this.$_.groupBy(t.data.notification_types,"id")).map(Number),this.$store.commit("setPageTitle","Edit User Role "+this.name)})):this.$store.commit("setPageTitle","Create User Role")):this.$router.push({name:"Error403"})},data(){return{toolbarButtons:[{label:"Save",id:"save",type:"button",color:"teal"}],name:null,permissionsCollection:[],permissions:[],notification_types:[],headers:["Model","Create","Update","View","View Any","Delete"],errors:{name:null},tab:"permissions",notificationCollection:[]}},computed:{breadcrumbs(){return[{label:"Dashboard",link:"/"},{label:"User Roles",link:"/user_roles"},{label:this.$route.params.id?this.name:"Create",link:"",disabled:!0}]}},methods:{saveFn(){this.$q.loading.show();let t="user_roles";this.$route.params.id&&(t="user_roles/"+this.$route.params.id),this.$axios.post(t,{permissions:this.permissions,notification_types:this.notification_types,name:this.name,_method:this.$route.params.id?"PUT":"POST"}).then((t=>{"success"===t.data.message&&(this.$q.notify({type:"positive",message:"Role Saved Successfully"}),this.$router.back())})).catch((t=>{422===t.response.status&&(this.$q.notify({type:"negative",message:t.response.data.message}),Object.keys(t.response.data.errors).forEach(((e,s)=>{this.errors[e]=t.response.data.errors[e][0]})))})).finally((()=>{this.$q.loading.hide()}))},selectAll(){this.permissionsCollection.forEach((t=>{this.permissions.push(t.id)}))},selectAllNotifications(){this.notificationCollection.forEach((t=>{this.notification_types.push(t.id)}))},resetFn(){this.permissions=[]},resetNotifications(){this.notification_types=[]}}},l=n,c=s("2877"),m=s("9989"),d=s("f09f"),p=s("a370"),u=s("27f9"),b=s("429b"),h=s("7460"),f=s("eb85"),q=s("adad"),y=s("823b"),v=s("9c40"),_=s("8f8e"),k=s("2bb1"),C=s("bd08"),g=s("db86"),$=s("eebe"),x=s.n($),w=Object(c["a"])(l,a,i,!1,null,null,null);e["default"]=w.exports;x()(w,"components",{QPage:m["a"],QCard:d["a"],QCardSection:p["a"],QInput:u["a"],QTabs:b["a"],QTab:h["a"],QSeparator:f["a"],QTabPanels:q["a"],QTabPanel:y["a"],QBtn:v["a"],QCheckbox:_["a"],QMarkupTable:k["a"],QTr:C["a"],QTd:g["a"]})}}]);