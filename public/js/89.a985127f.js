(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[89],{"53b8":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("page-toolbar",{attrs:{buttons:t.toolbarButtons},on:{activate:function(e){return t.activate()}}}),a("breadcrumbs",{attrs:{breadcrumbs:t.breadcrumbs}}),a("div",{class:t.$q.screen.gt.sm?"q-px-lg q-mt-md":"q-px-xs q-mt-sm"},[a("q-card",[a("div",{staticClass:"row q-col-gutter-md q-pa-md "},[a("div",{staticClass:"col-12 col-md-6"},[a("q-markup-table",{attrs:{"wrap-cells":"",separator:"cell"}},[a("tbody",[a("tr",[a("td",[t._v("Serial No")]),a("td",[t._v(t._s(t.serial_no))])]),t.sale_order.customer?a("tr",[a("td",[t._v("Customer")]),a("td",[a("router-link",{attrs:{to:"/customers/view/"+t.sale_order.customer.id}},[t._v(t._s(t.sale_order.customer.name))])],1)]):t._e(),t.sale_order.warehouse?a("tr",[a("td",[t._v("Warehouse")]),a("td",[t._v(t._s(t.sale_order.warehouse.name))])]):t._e(),a("tr",[a("td",[t._v("Sale Order")]),a("td",[a("router-link",{attrs:{to:"/sale_orders/view/"+t.sale_order.id}},[t._v(t._s(t.sale_order.serial_no))])],1)])])])],1),a("div",{staticClass:"col-12 col-md-6"},[a("q-markup-table",{attrs:{"wrap-cells":"",separator:"cell"}},[a("tbody",[a("tr",[a("td",[t._v("Status")]),a("td",[t._v(t._s(t.status))])]),a("tr",[a("td",[t._v("Created By")]),a("td",[t._v(t._s(t.created_by.name))])]),a("tr",[a("td",[t._v("Created At")]),a("td",[t._v(t._s(t.getLocaleString(t.created_at)))])])])])],1)]),a("div",{staticClass:"row q-col-gutter-md q-pa-md "},[a("div",{staticClass:"col"},[a("q-table",{staticClass:"my-sticky-header-table",attrs:{columns:t.columns,title:"Items",data:t.items,"row-key":"sl_no","wrap-cells":"",loading:t.table_loading,"rows-per-page-options":[0],filter:t.search},scopedSlots:t._u([{key:"body",fn:function(e){return[a("q-tr",{attrs:{props:e}},[a("q-td",{staticClass:"text-right"},[t._v(t._s(e.rowIndex+1))]),a("q-td",[t._v("\n                                    "+t._s(e.row.product.name)+"\n                                    "),a("q-btn",{attrs:{icon:"content_copy",flat:"",round:""},on:{click:function(a){return t.$store.dispatch("copyToClipboard",e.row.name)}}})],1),a("q-td",{staticClass:"text-right"},[e.row.gst?a("div",[t._v("\n                                        "+t._s(e.row.gst)+"%\n                                    ")]):t._e()]),a("q-td",{staticClass:"text-right"},[t._v("\n                                    "+t._s(e.row.qty.toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2}))+"\n                                    "),a("q-popup-edit",{attrs:{buttons:"","label-set":"Save","label-cancel":"Close",validate:function(){return!!t.$refs.qty_edit.validate()}},on:{hide:function(a){t.updateRow(e.rowIndex),e.row.qty=parseInt(e.row.qty)}},model:{value:e.row.qty,callback:function(a){t.$set(e.row,"qty",a)},expression:"props.row.qty"}},[a("q-input",{ref:"qty_edit",staticClass:"input-right",attrs:{dense:"",autofocus:"",rules:[function(t){return!isNaN(t)||"Invalid"}]},on:{focus:function(e){return t.$refs.qty_edit.select()}},model:{value:e.row.qty,callback:function(a){t.$set(e.row,"qty",a)},expression:"props.row.qty"}})],1)],1),a("q-td",{staticClass:"text-right"},[t._v("\n                                        "+t._s(e.row.is_free?"Yes":"No")+"\n                                ")]),a("q-td",{staticClass:"text-right"},[t._v("\n                                    "+t._s(e.row.rate.toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2}))+"\n                                ")]),t.sale_order&&!t.sale_order.rate_includes_gst?a("q-td",{staticClass:"text-right"},[t._v("\n                                    "+t._s(e.row.taxable.toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2}))+"\n                                ")]):t._e(),t.sale_order&&!t.sale_order.rate_includes_gst?a("q-td",{staticClass:"text-right"},[t._v("\n                                    "+t._s(e.row.tax_amount.toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2}))+"\n                                ")]):t._e(),a("q-td",{staticClass:"text-right"},[t._v("\n                                    "+t._s(e.row.total)+"\n                                ")])],1)]}},{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})]},proxy:!0},{key:"bottom-row",fn:function(){return[a("q-tr",{staticClass:"bg-blue-grey-3"},[a("q-td",{attrs:{colspan:t.sale_order&&!t.sale_order.rate_includes_gst?7:5}}),a("q-td",{staticClass:"text-right"},[t._v("Subtotal")]),a("q-td",{staticClass:"text-right"},[t._v(t._s(t.subtotal.toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2})))])],1),a("q-tr",{staticClass:"bg-blue-grey-1"},[a("q-td",{attrs:{colspan:t.sale_order&&!t.sale_order.rate_includes_gst?7:5}}),a("q-td",{staticClass:"text-right"},[t._v("Freight")]),a("q-td",{staticClass:"text-right"},[t._v("\n                              "+t._s(t.freight?parseFloat(t.freight).toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00")+"\n                              "),a("q-popup-edit",{attrs:{buttons:"","label-set":"Save","label-cancel":"Close",validate:function(){return!!t.$refs.freight_edit.validate()}},on:{hide:function(e){t.freight=parseFloat(t.freight).toFixed(2),t.updateTotal()}},model:{value:t.freight,callback:function(e){t.freight=e},expression:"freight"}},[a("q-input",{ref:"freight_edit",staticClass:"input-right",attrs:{dense:"",autofocus:"",rules:[function(t){return!isNaN(t)||"Invalid"}]},on:{focus:function(e){return t.$refs.freight_edit.select()}},model:{value:t.freight,callback:function(e){t.freight=e},expression:"freight"}})],1)],1)],1),a("q-tr",{staticClass:"bg-blue-grey-3"},[a("q-td",{attrs:{colspan:t.sale_order&&!t.sale_order.rate_includes_gst?7:5}}),a("q-td",{staticClass:"text-right"},[t._v("Total")]),a("q-td",{staticClass:"text-right"},[t._v(t._s(t.total.toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2})))])],1)]},proxy:!0}])})],1)]),a("div",{staticClass:"row q-mt-sm"},[a("div",{staticClass:"col q-px-md"},[a("div",{staticClass:"text-h6"},[t._v("Remarks")]),a("q-editor",{attrs:{rows:"3"},model:{value:t.remarks,callback:function(e){t.remarks=e},expression:"remarks"}})],1)])])],1),a("page-toolbar",{staticClass:"q-mt-md",attrs:{"page-title":"",buttons:t.toolbarButtons},on:{activate:function(e){return t.activate()}}})],1)},r=[],i=(a("e6cf"),a("a79d"),a("a89c")),o=a("b6c6"),l={name:"SaleOrdersView",components:{PageToolbar:i["a"],Breadcrumbs:o["a"]},data(){return{serial_no:"",sale_order:{customer:null,warehouse:null},created_by:{name:null},created_at:null,status:null,remarks:"",items:[],subtotal:null,freight:null,total:null,search:null,table_loading:!1,errorQty:!1,errorMessageQty:""}},mounted(){this.getDataFromApi()},computed:{toolbarButtons(){const t=[];return this.$store.getters.hasPermissionTo("invoice_sale_order")&&"Active"!==this.status&&t.push({label:"Activate",id:"activate",type:"button",color:"green-7",icon:"check"}),t},columns(){const t=[{name:"sl_no",field:"sl_no",label:"#",sortable:!0},{name:"name",field:"name",label:"Product",sortable:!0,align:"left"},{name:"gst",field:"gst",label:"GST",sortable:!0},{name:"qty",field:"qty",label:"Qty",sortable:!0},{name:"is_free",field:"is_free",label:"Free ?",sortable:!0},{name:"rate",field:"rate",label:"Rate",sortable:!0}];return this.sale_order&&!this.sale_order.rate_includes_gst&&t.push({name:"taxable",field:"taxable",label:"Taxable",sortable:!0},{name:"tax_amount",field:"tax_amount",label:"Tax Amount",sortable:!0}),t.push({name:"total",field:"total",label:"Total",sortable:!0}),t},breadcrumbs(){const t=[{label:"Dashboard",link:"/"},{label:"Sale Returns",link:"/sale_returns"},{label:this.serial_no}];return t}},watch:{},methods:{update(){this.$q.loading.show(),this.$axios.post("sale_returns/"+this.$route.params.id,{_method:"PUT",items:this.items,subtotal:this.subtotal,total:this.total,freight:this.freight}).then((t=>{"success"===t.data.message&&this.$q.notify({type:"positive",message:"Updated Successfully"})})).finally((()=>{this.$q.loading.hide()}))},getDataFromApi(){this.$q.loading.show(),this.$axios.get("sale_returns/"+this.$route.params.id).then((t=>{this.serial_no=t.data.serial_no,this.sale_order=t.data.sale_order,this.created_by=t.data.created_by,this.created_at=t.data.created_at,this.status=t.data.status,this.remarks=t.data.remarks,this.items=t.data.items,this.subtotal=t.data.subtotal,this.freight=t.data.freight,this.total=t.data.total})).finally((()=>{this.$store.commit("setPageTitle",this.serial_no),this.$q.loading.hide()}))},getLocaleString(t){if(t){const e=new Date(t);return e.toLocaleString("en-IN")}return""},qtyEditValidation(t){return t&&Number.isInteger(Number(t))?(this.errorQty=!1,this.errorMessageQty="",!0):(this.errorQty=!0,this.errorMessageQty="Invalid Entry",!1)},freightEditValidation(t){return t&&Number.isInteger(Number(t))?(this.errorQty=!1,this.errorMessageQty="",!0):(this.errorQty=!0,this.errorMessageQty="Invalid Entry",!1)},updateRow(t){const e=parseFloat(this.items[t].total),a=parseInt(this.items[t].qty),s=parseFloat(this.items[t].rate),r=parseFloat(this.items[t].gst);let i=0;if(this.sale_order.rate_includes_gst)i=s*a,this.items[t].total=i.toFixed(2);else{let e=0;e=s*a,this.items[t].taxable=e.toFixed(2);const o=e*(r/100);this.items[t].tax_amount=o.toFixed(2),i=e+o,this.items[t].total=i.toFixed(2)}const o=i-e;this.addtoSubtotal(o),this.updateTotal()},addtoSubtotal(t){this.subtotal=(parseFloat(this.subtotal)+parseFloat(t)).toFixed(2)},updateTotal(){const t=parseFloat(this.subtotal),e=parseFloat(this.freight);let a=0;a=t+e,this.total=Math.round(a).toFixed(2),this.update()},activate(){this.$axios.post("sale_returns/activate/"+this.$route.params.id,{remarks:this.remarks}).then((t=>{"success"===t.data.message&&(this.$router.push("/sale_returns"),this.$q.notify({type:"positive",message:"Sale Return Activated Successfully"}))}))}}},n=l,d=a("2877"),c=a("9989"),u=a("f09f"),m=a("2bb1"),_=a("eaac"),h=a("bd08"),g=a("db86"),b=a("9c40"),p=a("42a1"),f=a("27f9"),v=a("0016"),q=a("d66b"),y=a("eebe"),x=a.n(y),w=Object(d["a"])(n,s,r,!1,null,null,null);e["default"]=w.exports;x()(w,"components",{QPage:c["a"],QCard:u["a"],QMarkupTable:m["a"],QTable:_["a"],QTr:h["a"],QTd:g["a"],QBtn:b["a"],QPopupEdit:p["a"],QInput:f["a"],QIcon:v["a"],QEditor:q["a"]})}}]);