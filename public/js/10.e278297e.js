(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{e5f2:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",[s("page-toolbar",{attrs:{buttons:t.toolbarButtons},on:{save:function(e){return t.saveFn()},sendToAdmin:function(e){return t.sendToAdmin()}}}),s("breadcrumbs",{attrs:{breadcrumbs:t.breadcrumbs}}),s("div",{class:t.$q.screen.gt.sm?"q-px-lg q-mt-md":"q-px-xs q-mt-sm"},[s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-md-6 col-12 q-mt-md"},[s("q-input",{ref:"bill_number",attrs:{outlined:"",dense:"",square:"",label:"Bill No.",rules:[function(t){return!!t||"Required"}]},model:{value:t.bill_number,callback:function(e){t.bill_number=e},expression:"bill_number"}})],1),s("div",{staticClass:"col-md-3 col-12 q-mt-md"},[s("q-input",{attrs:{readonly:"",dense:"",outlined:"",square:"",label:"Status"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1),s("div",{staticClass:"col-md-3 col-12 q-mt-md"},[s("q-input",{attrs:{readonly:"",dense:"",outlined:"",square:"",label:"GRN No"},model:{value:t.grn_serial_no,callback:function(e){t.grn_serial_no=e},expression:"grn_serial_no"}})],1)]),s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-md-6 col-12 q-mt-md"},[s("q-input",{attrs:{readonly:"",value:t.supplier.name,outlined:"",square:"",dense:"",label:"Supplier"}})],1),s("div",{staticClass:"col-md-6 col-12 q-mt-md"},[s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col"},[s("q-input",{ref:"bill_date",attrs:{filled:"",dense:"",label:"Bill date",hint:"Click on calender icon to enter date",rules:[function(t){return!!t||"Required"},t.dateValidation],"lazy-rules":"ondemand",mask:"####-##-##"},on:{input:function(e){return t.$refs.bill_date.resetValidation()}},scopedSlots:t._u([{key:"append",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[s("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[s("q-date",{model:{value:t.bill_date,callback:function(e){t.bill_date=e},expression:"bill_date"}},[s("div",{staticClass:"row items-center justify-end"},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:t.bill_date,callback:function(e){t.bill_date=e},expression:"bill_date"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{filled:"",readonly:"",dense:"",label:"Delivery date"},model:{value:t.delivery_date,callback:function(e){t.delivery_date=e},expression:"delivery_date"}})],1)])])]),s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-md-6 col-12 q-mt-md"},[s("q-input",{attrs:{readonly:"",dense:"",outlined:"",square:"",value:t.warehouse.name,label:"Warehouse"}})],1),s("div",{staticClass:"col-md-6 col-12 q-mt-md"},[s("q-select",{ref:"created_by_id",attrs:{label:"Created By","emit-value":"","map-options":"","option-value":"id","option-label":"name",outlined:"",square:"",dense:"",rules:[function(t){return!!t||"Required"}],options:t.createdByOptions},model:{value:t.created_by_id,callback:function(e){t.created_by_id=e},expression:"created_by_id"}})],1)]),s("div",{staticClass:"row q-col-gutter-md q-mb-md"},[s("div",{staticClass:"col-3"},[s("q-toggle",{attrs:{label:"Row discount mode: "+t.row_discount_mode,color:"green","false-value":"fixed","true-value":"percentage"},model:{value:t.row_discount_mode,callback:function(e){t.row_discount_mode=e},expression:"row_discount_mode"}})],1),s("div",{staticClass:"col-3"},[s("q-select",{attrs:{outlined:"",dense:"",square:"",options:[{label:"Equal",value:"equal",description:"Freight will be equally divided by moving the line"},{label:"Weight",value:"weight",description:"Freight will be divided based on weight"}],label:"Freight Split Method","emit-value":""},scopedSlots:t._u([{key:"option",fn:function(e){return[s("q-item",t._g(t._b({},"q-item",e.itemProps,!1),e.itemEvents),[s("q-item-section",[s("q-item-label",{domProps:{innerHTML:t._s(e.opt.label)}}),s("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.opt.description))])],1)],1)]}}]),model:{value:t.freight_split_method,callback:function(e){t.freight_split_method=e},expression:"freight_split_method"}})],1)]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-table",{attrs:{columns:t.columns,title:"Items",data:t.items,"row-key":"product_id","wrap-cells":"",loading:t.table_loading,"rows-per-page-options":[0],filter:t.search},scopedSlots:t._u([{key:"bottom-row",fn:function(){return[s("q-tr",{staticClass:"bg-blue-grey-1"},[s("q-td",{attrs:{colspan:"6"}}),s("q-td",{staticClass:"text-right"},[t._v("Total")]),s("q-td",{staticClass:"text-right"},[t._v(t._s(t.tax_row_total.toFixed(2)))]),s("q-td",{staticClass:"text-right"},[t._v(t._s(t.taxable_total.toFixed(2)))]),s("q-td")],1)]},proxy:!0},{key:"header",fn:function(e){return[s("q-tr",{attrs:{props:e}},[s("q-th"),t._l(e.cols,(function(a){return s("q-th",{key:a.name,attrs:{props:e}},[t._v("\n                            "+t._s(a.label)+"\n                        ")])}))],2)]}},{key:"body",fn:function(e){return[s("q-tr",{attrs:{props:e}},[s("q-td",{attrs:{"auto-width":""}},[s("q-btn",{attrs:{size:"md",color:"grey-7",round:"",dense:"",flat:"",icon:e.expand?"arrow_drop_down":"arrow_right"},on:{click:function(t){e.expand=!e.expand}}})],1),s("q-td",{staticClass:"text-right"},[t._v(t._s(e.rowIndex+1))]),s("q-td",[t._v("\n                            "+t._s(e.row.product.name)+"\n                            "),s("q-btn",{attrs:{icon:"content_copy",flat:"",round:""},on:{click:function(s){return t.$store.dispatch("copyToClipboard",e.row.product.name)}}},[s("q-tooltip",[t._v("\n                                Copy Name\n                              ")])],1),s("q-btn",{attrs:{icon:"file_copy",flat:"",round:""},on:{click:function(s){return t.duplicateRow(e.row)}}},[s("q-tooltip",[t._v("\n                                Duplicate Row\n                              ")])],1)],1),s("q-td",{staticClass:"text-right"},[t._v("\n                            "+t._s(e.row.gst)+"%\n                            "),s("q-popup-edit",{attrs:{buttons:"","label-set":"Save","label-cancel":"Close"},on:{hide:function(s){return t.updateRow(e.rowIndex)}},model:{value:e.row.gst,callback:function(s){t.$set(e.row,"gst",s)},expression:"props.row.gst"}},[s("q-select",{attrs:{options:t.gstOptions,"map-options":"","emit-value":"",dense:"",autofocus:""},model:{value:e.row.gst,callback:function(s){t.$set(e.row,"gst",s)},expression:"props.row.gst"}})],1)],1),s("q-td",{staticClass:"text-right"},[t._v("\n                            "+t._s(e.row.qty)+"\n                            "),s("q-popup-edit",{attrs:{buttons:"","label-set":"Save","label-cancel":"Close",validate:function(e){return!0===t.qtyValidation(e)}},on:{hide:function(s){t.updateRow(e.rowIndex),e.row.qty=parseInt(e.row.qty)},show:function(e){return t.$refs.qty_edit.select()}},model:{value:e.row.qty,callback:function(s){t.$set(e.row,"qty",s)},expression:"props.row.qty"}},[s("q-input",{ref:"qty_edit",attrs:{rules:[t.qtyValidation],dense:"",autofocus:""},on:{input:function(e){return t.$refs.qty_edit.resetValidation()}},model:{value:e.row.qty,callback:function(s){t.$set(e.row,"qty",s)},expression:"props.row.qty"}})],1)],1),s("q-td",{staticClass:"text-right"},[t._v("\n                            "+t._s(e.row.rate)+"\n                            "),e.row.is_free?t._e():s("q-popup-edit",{attrs:{buttons:"","label-set":"Save","label-cancel":"Close",validate:function(e){return!0===t.rateEditValidation(e)}},on:{hide:function(s){t.updateRow(e.rowIndex),e.row.rate=parseFloat(e.row.rate).toFixed(2)},show:function(e){return t.$refs.rate_edit.select()}},model:{value:e.row.rate,callback:function(s){t.$set(e.row,"rate",s)},expression:"props.row.rate"}},[s("q-input",{ref:"rate_edit",attrs:{rules:[t.rateEditValidation],dense:"",autofocus:""},on:{input:function(e){return t.$refs.rate_edit.resetValidation()}},model:{value:e.row.rate,callback:function(s){t.$set(e.row,"rate",s)},expression:"props.row.rate"}})],1)],1),s("q-td",{staticClass:"text-right"},[t._v("\n                            "+t._s(e.row.discount)),"percentage"==t.row_discount_mode?s("span",[t._v("%")]):t._e(),e.row.is_free?t._e():s("q-popup-edit",{attrs:{buttons:"","label-set":"Save","label-cancel":"Close",validate:t.discountEditValidation},on:{hide:function(s){return t.updateRow(e.rowIndex)}},model:{value:e.row.discount,callback:function(s){t.$set(e.row,"discount",s)},expression:"props.row.discount"}},[s("q-input",{attrs:{error:t.errorDiscount,"error-message":t.errorMessageDiscount,dense:"",autofocus:""},on:{input:t.discountEditValidation},model:{value:e.row.discount,callback:function(s){t.$set(e.row,"discount",s)},expression:"props.row.discount"}})],1)],1),s("q-td",{staticClass:"text-right"},[t._v("\n                            "+t._s(e.row.tax_amount)+"\n                        ")]),s("q-td",{staticClass:"text-right"},[t._v("\n                            "+t._s(e.row.taxable)+"\n                        ")]),s("q-td",{staticClass:"text-right"},[s("q-btn",{attrs:{round:"",icon:"delete",flat:"",color:"black"},on:{click:function(s){return t.deleteFn(e.rowIndex)}}})],1)],1),s("q-tr",{directives:[{name:"show",rawName:"v-show",value:e.expand,expression:"props.expand"}],staticClass:"bg-grey-4",attrs:{props:e}},[s("q-td",{attrs:{colspan:"2"}}),s("q-td",{attrs:{colspan:"2"}},[t._v("\n                            Avoid Costing: "+t._s(e.row.local?"Yes":"No")+"\n                            "),s("q-popup-edit",{attrs:{buttons:"","label-set":"Save","label-cancel":"Close",validate:t.weightEditValidation},model:{value:e.row.local,callback:function(s){t.$set(e.row,"local",s)},expression:"props.row.local"}},[s("q-select",{attrs:{options:[{label:"Yes",value:1},{label:"No",value:0}],"emit-value":"","map-options":"",dense:"",autofocus:""},model:{value:e.row.local,callback:function(s){t.$set(e.row,"local",s)},expression:"props.row.local"}})],1)],1),s("q-td",{attrs:{colspan:"2"}},[t._v("\n                            Is free: "+t._s(e.row.is_free?"Yes":"No")+"\n                        ")]),s("q-td",{staticClass:"text-left",attrs:{colspan:"2"}},[t._v("\n                            Weight: "+t._s(e.row.weight)+"\n                            "),s("q-popup-edit",{attrs:{buttons:"","label-set":"Save","label-cancel":"Close",validate:t.weightEditValidation},model:{value:e.row.weight,callback:function(s){t.$set(e.row,"weight",s)},expression:"props.row.weight"}},[s("q-input",{attrs:{error:t.errorWeight,"error-message":t.errorMessageWeight,dense:"",autofocus:""},model:{value:e.row.weight,callback:function(s){t.$set(e.row,"weight",s)},expression:"props.row.weight"}})],1)],1),s("q-td",{staticClass:"text-left",attrs:{colspan:"2"}},[t._v("\n                            MRP: "+t._s(e.row.mrp)+"\n                            "),s("q-popup-edit",{attrs:{buttons:"","label-set":"Save","label-cancel":"Close",validate:t.weightEditValidation},model:{value:e.row.mrp,callback:function(s){t.$set(e.row,"mrp",s)},expression:"props.row.mrp"}},[s("q-input",{attrs:{error:t.errorWeight,"error-message":t.errorMessageWeight,dense:"",autofocus:""},model:{value:e.row.mrp,callback:function(s){t.$set(e.row,"mrp",s)},expression:"props.row.mrp"}})],1)],1),s("q-td",{staticClass:"text-left",attrs:{colspan:"2"}},[t._v("\n                            HSN: "+t._s(e.row.hsn)+"\n                            "),s("q-popup-edit",{attrs:{buttons:"","label-set":"Save","label-cancel":"Close"},model:{value:e.row.hsn,callback:function(s){t.$set(e.row,"hsn",s)},expression:"props.row.hsn"}},[s("q-input",{attrs:{dense:"",autofocus:""},model:{value:e.row.hsn,callback:function(s){t.$set(e.row,"hsn",s)},expression:"props.row.hsn"}})],1)],1)],1)]}},{key:"top-right",fn:function(){return[s("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:t._u([{key:"append",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})]},proxy:!0},{key:"body-cell-actions",fn:function(t){return[s("q-td",{attrs:{props:t}})]}}])})],1)]),s("div",{staticClass:"row q-col-gutter-xs q-mt-md"},[s("div",{staticClass:"col-4"},[s("q-select",{ref:"product",attrs:{clearable:"",tabindex:"1",outlined:"",square:"",dense:"",label:"Product",rules:[function(t){return!!t||"Required"}],"lazy-rules":"ondemand",options:t.productOptions,"option-value":"id","option-label":"name","use-input":"","fill-input":"","hide-selected":""},on:{filter:t.productFilter},scopedSlots:t._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[t._v("\n                        No results\n                        ")])],1)]},proxy:!0}]),model:{value:t.product,callback:function(e){t.product=e},expression:"product"}})],1),s("div",{staticClass:"col"},[s("q-checkbox",{staticClass:"q-mt-xs",attrs:{size:"xs",label:"Avoid Costing?",tabindex:"-1"},model:{value:t.local,callback:function(e){t.local=e},expression:"local"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"row_weight",attrs:{tabindex:"2",label:"Weight per item",square:"",outlined:"",dense:"",hint:"in grams",rules:[function(t){return!!t||"Required"},function(t){return Number(t)>0||"Invalid"}],"lazy-rules":"ondemand"},on:{focus:function(t){return t.target.select()},blur:function(){t.row_weight=t.row_weight?parseFloat(t.row_weight).toFixed(2):null}},model:{value:t.row_weight,callback:function(e){t.row_weight=e},expression:"row_weight"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"mrp",attrs:{label:"MRP",tabindex:"3",square:"",outlined:"",dense:"",rules:[function(t){return!isNaN(t)||"Invalid"}],"lazy-rules":"ondemand"},on:{focus:function(t){return t.target.select()},blur:function(){t.mrp=t.mrp?parseFloat(t.mrp).toFixed(2):null}},model:{value:t.mrp,callback:function(e){t.mrp=e},expression:"mrp"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"HSN",tabindex:"4",square:"",outlined:"",dense:""},model:{value:t.hsn,callback:function(e){t.hsn=e},expression:"hsn"}})],1)]),s("div",{staticClass:"row q-col-gutter-md q-mt-sm"},[s("div",{staticClass:"col"},[s("q-select",{ref:"gst",attrs:{tabindex:"5",outlined:"",square:"",dense:"",rules:[function(t){return!!t||"Required"}],"lazy-rules":"ondemand",options:t.gstOptions,label:"GST","map-options":"","emit-value":""},model:{value:t.gst,callback:function(e){t.gst=e},expression:"gst"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"qty",staticClass:"input-right",attrs:{tabindex:"6",outlined:"",square:"",dense:"",label:"Qty",rules:[t.qtyValidation],"lazy-rules":"ondemand"},on:{focus:function(t){return t.target.select()},blur:function(){t.qty=t.qty?parseInt(t.qty).toString():null}},model:{value:t.qty,callback:function(e){t.qty=e},expression:"qty"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"rate",attrs:{tabindex:"7",outlined:"",readonly:t.is_free,square:"",dense:"",label:"Rate",rules:[function(t){return!!t||"Required"},function(t){return!isNaN(t)||"Invalid"},t.rateValidation],"lazy-rules":"ondemand"},on:{focus:function(t){return t.target.select()},blur:function(){t.rate=t.rate?parseFloat(t.rate).toFixed(2):null}},model:{value:t.rate,callback:function(e){t.rate=e},expression:"rate"}})],1),s("div",{},[s("q-checkbox",{staticClass:"q-mt-xs",attrs:{label:"Free?",size:"xs"},model:{value:t.is_free,callback:function(e){t.is_free=e},expression:"is_free"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"row_discount",attrs:{outlined:"",square:"",dense:"",tabindex:"8",label:"Discount"},on:{focus:function(t){return t.target.select()},blur:function(){t.row_discount=t.row_discount?parseFloat(t.row_discount).toFixed(2):null}},model:{value:t.row_discount,callback:function(e){t.row_discount=e},expression:"row_discount"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{outlined:"",square:"",dense:"",readonly:"",label:"Taxable"},model:{value:t.row_taxable,callback:function(e){t.row_taxable=e},expression:"row_taxable"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{outlined:"",square:"",dense:"",readonly:"",label:"Tax Amount"},model:{value:t.row_tax_amount,callback:function(e){t.row_tax_amount=e},expression:"row_tax_amount"}})],1),s("div",{},[s("q-btn",{attrs:{icon:"add",tabindex:"9",round:"",flat:"",color:"teal"},on:{click:function(e){return t.addRow()}}})],1)]),s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col-12 col-md-10 q-px-md"}),s("div",{staticClass:"col-12 col-md-2"},[s("div",{staticClass:"column"},[s("div",{staticClass:"col"},[s("q-input",{ref:"taxable_discount",staticClass:"input-right",attrs:{tabindex:"11",label:"Discount on Taxable",dense:"",outlined:"",square:"",rules:[function(t){return!isNaN(t)||"Invalid"}]},on:{focus:function(e){return t.$refs.taxable_discount.select()}},scopedSlots:t._u([{key:"before",fn:function(){return[s("q-icon",{attrs:{name:"remove"}})]},proxy:!0}]),model:{value:t.taxable_discount,callback:function(e){t.taxable_discount=e},expression:"taxable_discount"}})],1),s("div",{staticClass:"col"},[s("q-input",{staticClass:"input-right q-mb-md",attrs:{label:"Items Tax",dense:"",outlined:"",square:"",readonly:""},model:{value:t.taxTotal,callback:function(e){t.taxTotal=e},expression:"taxTotal"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"bill_freight_gst",staticClass:"input-right",attrs:{tabindex:"12",label:"Bill Freight Tax",dense:"",outlined:"",square:"",rules:[function(t){return!isNaN(t)||"Invalid"}]},on:{focus:function(e){return t.$refs.bill_freight_gst.select()}},model:{value:t.bill_freight_gst,callback:function(e){t.bill_freight_gst=e},expression:"bill_freight_gst"}})],1),s("div",{staticClass:"col"},[s("q-input",{staticClass:"input-right q-mb-md",attrs:{label:"Subtotal (incl. GST)",dense:"",outlined:"",square:"",readonly:""},model:{value:t.subtotal,callback:function(e){t.subtotal=e},expression:"subtotal"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"discount_subtotal",staticClass:"input-right",attrs:{tabindex:"13",label:"Discount on Subtotal",dense:"",outlined:"",square:"",rules:[function(t){return!isNaN(t)||"Invalid"}]},on:{focus:function(e){return t.$refs.discount_subtotal.select()}},scopedSlots:t._u([{key:"before",fn:function(){return[s("q-icon",{attrs:{name:"remove"}})]},proxy:!0}]),model:{value:t.discount_subtotal,callback:function(e){t.discount_subtotal=e},expression:"discount_subtotal"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"bill_freight",staticClass:"input-right",attrs:{tabindex:"13",label:"Bill Freight",dense:"",outlined:"",square:"",rules:[function(t){return!isNaN(t)||"Invalid"}]},on:{focus:function(e){return t.$refs.bill_freight.select()}},model:{value:t.bill_freight,callback:function(e){t.bill_freight=e},expression:"bill_freight"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"round",staticClass:"input-right",attrs:{label:"Round",tabindex:"14",dense:"",outlined:"",square:"",rules:[function(t){return!isNaN(t)||"Invalid"}]},on:{focus:function(e){return t.$refs.round.select()}},model:{value:t.round,callback:function(e){t.round=e},expression:"round"}})],1),s("div",{staticClass:"col"},[s("q-input",{staticClass:"input-right q-mb-md",attrs:{label:"Bill Total",dense:"",outlined:"",readonly:"",square:""},model:{value:t.bill_total,callback:function(e){t.bill_total=e},expression:"bill_total"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"external_freight",staticClass:"input-right",attrs:{label:"External Freight",tabindex:"14",dense:"",outlined:"",square:"",rules:[function(t){return!isNaN(t)||"Invalid"}]},on:{focus:function(e){return t.$refs.external_freight.select()}},model:{value:t.external_freight,callback:function(e){t.external_freight=e},expression:"external_freight"}})],1),s("div",{staticClass:"col"},[s("q-input",{staticClass:"input-right",attrs:{label:"Grand Total",dense:"",outlined:"",square:"",readonly:""},model:{value:t.grand_total,callback:function(e){t.grand_total=e},expression:"grand_total"}})],1)])])]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-subtitle1 q-mt-md"},[t._v("Remarks")]),s("q-editor",{attrs:{"min-height":"5rem"},model:{value:t.remarks,callback:function(e){t.remarks=e},expression:"remarks"}})],1)])]),s("page-toolbar",{staticClass:"q-mt-md",attrs:{"page-title":"",buttons:t.toolbarButtons},on:{save:function(e){return t.saveFn()},sendToAdmin:function(e){return t.sendToAdmin()}}})],1)},i=[],o=(s("c975"),s("a434"),s("e6cf"),s("a79d"),s("ddb0"),s("a89c")),l=s("b6c6"),r={name:"PurchasesCreate",components:{PageToolbar:o["a"],Breadcrumbs:l["a"]},data(){return{grn_id:null,grn_serial_no:null,bill_number:null,supplier:null,warehouse:null,items:[],round:0,discount_subtotal:0,taxable_discount:0,discount:0,bill_freight:0,bill_freight_includes_gst:"No",bill_freight_gst:0,external_freight:0,status:"Draft",bill_date:null,delivery_date:null,products:[],productOptions:[],gstOptions:[],product:null,gst:null,qty:null,rate:null,mrp:null,row_discount:null,row_discount_mode:"percentage",row_taxable:null,row_tax_amount:null,row_weight:null,is_free:!1,local:!1,hsn:null,created_by_id:null,createdByOptions:[],taxable_total:0,tax_row_total:0,tax_total:0,columns:[{name:"sl_no",field:"sl_no",label:"#",sortable:!0},{name:"name",field:"name",label:"Product",sortable:!0,align:"left"},{name:"gst",field:"gst",label:"GST",sortable:!0},{name:"qty",field:"qty",label:"Qty",sortable:!0},{name:"rate",field:"rate",label:"Rate",sortable:!0},{name:"discount",field:"discount",label:"Disc.",sortable:!0},{name:"tax_amount",field:"tax_amount",label:"Tax Amt",sortable:!0},{name:"taxable",field:"taxable",label:"Taxable",sortable:!0},{name:"actions",field:"actions",label:"",sortable:!1}],table_loading:!1,search:null,prodLoading:!1,errorQty:!1,errorMessageQty:"",errorRate:!1,errorMessageRate:"",errorDiscount:!1,errorMessageDiscount:"",errorWeight:!1,errorMessageWeight:"",remarks:"",freight_split_method:"weight"}},computed:{toolbarButtons(){const t=[];return(this.$store.getters.hasPermissionTo("create_purchase")||this.$store.getters.hasPermissionTo("update_purchase"))&&(t.push({label:"Send to Admin",id:"sendToAdmin",type:"button",color:"blue-10",icon:"forward"}),t.push({label:"Save as Draft",id:"save",type:"button",color:"teal",icon:"save"})),t},breadcrumbs(){const t=[{label:"Dashboard",link:"/"},{label:"Purchases",link:"/purchases"},{label:this.$route.params.id?this.bill_number:"Create",link:"/purchases/view/"+this.$route.params.id}];return this.$route.params.id&&t.push({label:"Edit",link:""}),t},taxTotal(){if(parseFloat(this.taxable_discount)>0){const t=parseFloat(this.taxable_discount)/parseFloat(this.taxable_total);return this.$_.sumBy(this.items,(e=>parseFloat(e.taxable)*(1-t)*parseFloat(e.gst)/100)).toFixed(2)}return this.tax_row_total},bill_total(){return(parseFloat(this.subtotal)-parseFloat(this.discount_subtotal)+parseFloat(this.bill_freight)+parseFloat(this.round)).toFixed(2)},grand_total(){return(parseFloat(this.bill_total)+parseFloat(this.external_freight)).toFixed(2)},subtotal(){return(parseFloat(this.taxable_total)-parseFloat(this.taxable_discount)+parseFloat(this.taxTotal)+parseFloat(this.bill_freight_gst)).toFixed(2)}},mounted(){if(this.$store.getters.hasPermissionTo("create_purchase")){this.$q.loading.show();const t=["create_purchase","update_purchase"];Promise.all([this.$axios.get("gst_options").then((t=>{this.gstOptions=t.data})),this.$axios.get("users/has_permission?permissions="+encodeURIComponent(JSON.stringify(t))).then((t=>{this.createdByOptions=t.data}))]).finally((()=>{this.$q.loading.hide()})),this.$route.params.id?(this.$q.loading.show(),this.$axios.get("purchases/"+this.$route.params.id).then((t=>{this.bill_number=t.data.bill_number,this.status=t.data.status,this.supplier=t.data.supplier,this.created_by_id=t.data.created_by_id,this.bill_date=t.data.bill_date,this.delivery_date=t.data.delivery_date,this.warehouse=t.data.warehouse,this.row_discount_mode=t.data.row_discount_mode,this.discount_subtotal=t.data.discount_subtotal,this.taxable_discount=t.data.taxable_discount,this.bill_freight=t.data.bill_freight,this.bill_freight_gst=t.data.bill_freight_gst,this.round=t.data.round,this.external_freight=t.data.external_freight,this.remarks=t.data.remarks?t.data.remarks:"",this.items=t.data.items,this.taxable_total=parseFloat(t.data.taxable_total),this.tax_row_total=parseFloat(t.data.tax_row_total),this.products=this.$_.map(t.data.grn.items,(t=>({name:t.product.name,id:t.product.id})))})).finally((()=>{this.$store.commit("setPageTitle","Edit Purchase: "+this.bill_number),this.$q.loading.hide()}))):this.$store.commit("setPageTitle","Create Purchase"),this.$route.query.grn_id&&(this.$q.loading.show(),this.grn_id=this.$route.query.grn_id,this.$axios.get("goods_receive_notes/"+this.$route.query.grn_id).then((t=>{this.supplier={id:t.data.supplier.id,name:t.data.supplier.name},this.grn_serial_no=t.data.serial_no,this.delivery_date=t.data.delivery_date,this.warehouse=t.data.warehouse,this.remarks=t.data.remarks?t.data.remarks:"",this.products=this.$_.map(t.data.items,(t=>({name:t.product.name,id:t.product.id})))})))}else this.$router.push({name:"Error403"})},methods:{dateValidation(t){return t?!!/^-?[\d]+-[0-1]\d-[0-3]\d$/.test(t)||"Invalid Date":"Required"},productFilter(t,e,s){e(""!==t?()=>{const e=t.toLowerCase();this.productOptions=this.products.filter((t=>t.name.toLowerCase().indexOf(e)>-1))}:()=>{this.productOptions=this.products})},addRow(){this.$refs.product.validate()&this.$refs.gst.validate()&this.$refs.qty.validate()&this.$refs.rate.validate()&this.$refs.row_weight.validate()&this.$refs.mrp.validate()&&(this.items.push({sl_no:this.items.length+1,name:this.product.name,mrp:this.mrp,product_id:this.product.id,product:this.product,hsn:this.hsn,gst:this.gst,qty:this.qty,is_free:this.is_free,local:this.local,rate:this.rate,discount:this.row_discount||"0.00",taxable:this.row_taxable,tax_amount:this.row_tax_amount,weight:this.row_weight}),this.pushTotal(this.row_tax_amount,this.row_taxable),this.product=null,this.hsn=null,this.gst=null,this.qty=null,this.is_free=!1,this.mrp=null,this.rate=null,this.row_discount=null,this.row_taxable=null,this.row_tax_amount=null,this.$nextTick((()=>{this.$refs.product.focus()})))},pushTotal(t,e){this.taxable_total+=parseFloat(e),this.tax_row_total+=parseFloat(t)},deleteFn(t){this.$q.dialog({title:"Confirm",message:"Would you like to delete this record?",cancel:!0,persistent:!0}).onOk((()=>{const e=parseFloat(this.items[t].taxable),s=parseFloat(this.items[t].tax_amount);this.pushTotal(-1*s,-1*e),this.items.splice(t,1)})).onCancel((()=>{}))},qtyValidation(t){return t?Number.isInteger(Number(t))?!(Number(t)<1)||"Invalid":"Must be an Integer":"Required"},rateEditValidation(t){return!!(t&&!isNaN(t)&&parseFloat(t)>0)||"Invalid Entry"},weightEditValidation(t){return t&&!isNaN(t)&&parseFloat(t)>0?(this.errorWeight=!1,this.errorMessageWeight="",!0):(this.errorWeight=!0,this.errorMessageWeight="Invalid Entry",!1)},discountEditValidation(t){return null!=t&&isNaN(t)?(this.errorDiscount=!0,this.errorMessageDiscount="Invalid Entry",!1):(this.errorDiscount=!1,this.errorMessageDiscount="",!0)},rateValidation(t){return!!this.is_free||(parseFloat(this.rate)>0||"Invalid")},updateRow(t){const e=parseFloat(this.items[t].taxable),s=parseFloat(this.items[t].tax_amount),a=parseInt(this.items[t].qty),i=parseFloat(this.items[t].rate),o=this.items[t].discount?parseFloat(this.items[t].discount):0,l=parseFloat(this.items[t].gst);let r=0;r="percentage"===this.row_discount_mode?i*a*(1-o/100):i*a-o,this.items[t].taxable=r.toFixed(2);const n=r*(l/100);this.items[t].tax_amount=n.toFixed(2);const d=r-e,u=n-s;this.pushTotal(u,d)},sendToAdmin(){this.saveFn("Pending Approval")},saveFn(t="Draft"){if(this.$refs.bill_number.validate()&this.$refs.bill_date.validate()&this.$refs.created_by_id.validate()&this.$refs.taxable_discount.validate()&this.$refs.bill_freight_gst.validate()&this.$refs.discount_subtotal.validate()&this.$refs.bill_freight.validate()&this.$refs.round.validate()&this.$refs.external_freight.validate()&this.validateItemsCount()){const e={_method:this.$route.params.id?"PUT":"POST",bill_number:this.bill_number,grn_id:this.grn_id,status:t,supplier_id:this.supplier.id,created_by_id:this.created_by_id,bill_date:this.bill_date,delivery_date:this.delivery_date,warehouse_id:this.warehouse.id,items:this.$_.map(this.items,this.$_.partialRight(this.$_.pick,["product_id","qty","rate","is_free","local","gst","discount","weight","mrp","hsn"])),remarks:this.remarks,discount_subtotal:this.discount_subtotal,taxable_discount:this.taxable_discount,bill_freight:this.bill_freight,external_freight:this.external_freight,bill_freight_gst:this.bill_freight_gst,round:this.round,row_discount_mode:this.row_discount_mode,freight_split_method:this.freight_split_method};let s="purchases";this.$route.params.id&&(s="purchases/"+this.$route.params.id),this.$q.loading.show(),this.$axios.post(s,e).then((t=>{"success"===t.data.message&&(this.$q.loading.hide(),this.$q.notify({type:"positive",message:"Saved Succesfully."}),this.$router.push("/purchases"))})).catch((t=>{if(this.$q.loading.hide(),422===t.response.status){this.$q.notify({type:"negative",message:t.response.data.message});let e="";Object.keys(t.response.data.errors).forEach((s=>{e+="<p>"+t.response.data.errors[s][0]+"</p>"})),this.$q.dialog({message:e,html:!0})}})).finally((()=>{this.$q.loading.hide()}))}else this.$q.notify({type:"negative",message:"Invalid data given !!!"})},validateItemsCount(){return this.items.length>0||(this.$q.notify({type:"negative",message:"There should be atleast one item"}),!1)},updateFields(){const t=this.qty?parseInt(this.qty):0,e=this.rate?parseFloat(this.rate):0,s=this.row_discount?parseFloat(this.row_discount):0,a=this.gst?parseFloat(this.gst):0;let i=0;i="percentage"===this.row_discount_mode?e*t*(1-s/100):e*t-s,this.row_taxable=i.toFixed(2);const o=i*(a/100);this.row_tax_amount=o.toFixed(2)},duplicateRow(t){this.items.push(this.$_.cloneDeep(t))}},watch:{is_free(t,e){t&&(this.rate="0.00",this.$nextTick((()=>{this.$refs.rate.validate()})))},product(t,e){t&&this.$axios.get("products/"+t.id).then((t=>{this.gst=t.data.gst,this.row_weight=t.data.weight,this.hsn=t.data.hsn,this.mrp=t.data.mrp}))},qty(t,e){this.updateFields()},rate(t,e){this.updateFields()},row_discount(t,e){this.updateFields()},gst(t,e){this.updateFields()}}},n=r,d=s("2877"),u=s("9989"),c=s("27f9"),p=s("0016"),h=s("7cbe"),_=s("52ee"),b=s("9c40"),m=s("ddd8"),f=s("9564"),g=s("66e5"),v=s("4074"),x=s("0170"),q=s("eaac"),w=s("bd08"),y=s("db86"),C=s("357e"),k=s("05c0"),$=s("42a1"),F=s("8f8e"),T=s("d66b"),N=s("7f67"),I=s("eebe"),S=s.n(I),R=Object(d["a"])(n,a,i,!1,null,null,null);e["default"]=R.exports;S()(R,"components",{QPage:u["a"],QInput:c["a"],QIcon:p["a"],QPopupProxy:h["a"],QDate:_["a"],QBtn:b["a"],QSelect:m["a"],QToggle:f["a"],QItem:g["a"],QItemSection:v["a"],QItemLabel:x["a"],QTable:q["a"],QTr:w["a"],QTd:y["a"],QTh:C["a"],QTooltip:k["a"],QPopupEdit:$["a"],QCheckbox:F["a"],QEditor:T["a"]}),S()(R,"directives",{ClosePopup:N["a"]})}}]);