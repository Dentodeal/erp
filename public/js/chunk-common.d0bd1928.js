(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"651b":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",[s("page-toolbar",{attrs:{buttons:e.toolbarButtons},on:{save:function(t){return e.saveFn()},activate:function(t){return e.activate()},sendforapproval:e.sendforapproval}}),s("breadcrumbs",{attrs:{breadcrumbs:e.breadcrumbs}}),s("div",{class:e.$q.screen.gt.sm?"q-px-lg q-mt-md":"q-px-xs q-mt-sm"},[s("q-card",[s("q-card-section",[s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-xs-12 col-md-6"},[s("div",{staticClass:"row q-mt-md"},[s("div",{staticClass:"col"},[s("q-select",{ref:"type",attrs:{outlined:"",square:"",dense:"",options:e.type_options,label:e.getTypeLabel,tabindex:"1",rules:[function(e){return!!e||"Required"}],"lazy-rules":"ondemand"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}})],1),s("div",{staticClass:"col"},[e.isLead?e._e():s("q-input",{attrs:{dense:"",outlined:"",square:"",readonly:"",label:"Status"},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}})],1)]),s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},[s("q-input",{ref:"name",attrs:{tabindex:"2",square:"",dense:"",outlined:"",label:"Name",disable:"Draft"!=e.status,rules:[function(e){return!!e||"Required"}],"lazy-rules":"ondemand","error-message":e.errors.name,error:e.errors.name.length>0},on:{blur:function(t){e.name=e.capitaliseFn(e.name)}},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)]),s("div",{staticClass:"row q-mt-md"},[s("div",{staticClass:"col"},[s("q-input",{ref:"gst_number",attrs:{square:"",dense:"",disable:!e.has_gst,outlined:"",label:"GST No.","error-message":e.gst_error_message,error:e.gst_error_message.length>0},model:{value:e.gst_number,callback:function(t){e.gst_number=t},expression:"gst_number"}})],1),s("div",{staticClass:"col"},[s("q-checkbox",{attrs:{label:"Has GST?"},on:{input:function(t){return e.$refs.gst_number.focus()}},model:{value:e.has_gst,callback:function(t){e.has_gst=t},expression:"has_gst"}})],1),s("div",{staticClass:"col"},[s("q-input",{ref:"initial_balance",staticClass:"input-right",attrs:{label:"Initial Balance",outlined:"",square:"",dense:"",rules:[function(e){return!isNaN(e)||"Invalid"},function(e){return!(null===e||""===e)||"Invalid"}]},on:{focus:function(t){return e.$refs.initial_balance.select()}},model:{value:e.initial_balance,callback:function(t){e.initial_balance=e._n(t)},expression:"initial_balance"}})],1)]),s("div",{staticClass:"row q-mt-md"},[s("div",{staticClass:"col"},[s("q-select",{ref:"tags",attrs:{square:"",outlined:"",dense:"",label:"Tags",options:e.tagOptions,"use-input":"","use-chips":"",multiple:"","input-debounce":"0"},on:{"new-value":e.newTag,filter:e.tagFilterFn},model:{value:e.tags,callback:function(t){e.tags=t},expression:"tags"}})],1)]),s("div",{staticClass:"row q-mt-md"},[s("div",{staticClass:"col"},[s("q-select",{ref:"representative",attrs:{tabindex:"3",label:"Representative",outlined:"",square:"",dense:"",options:e.representativeOptions,"option-value":"id","option-label":"name","map-options":"","emit-value":"",rules:[function(e){return e.length>0||"Required"}],"lazy-rules":"ondemand","use-chips":"",multiple:""},scopedSlots:e._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[e._v("\n                                            No results\n                                            ")])],1)]},proxy:!0}]),model:{value:e.representatives,callback:function(t){e.representatives=t},expression:"representatives"}})],1)])]),s("div",{staticClass:"col-12 col-md-6"},[s("div",{staticClass:"text-subtitle2"},[e._v(" Remarks")]),s("q-editor",{attrs:{rows:"10"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)]),e._l(e.emails,(function(t,i){return s("div",{key:i+"email",staticClass:"row q-col-gutter-md q-mt-xs"},[s("div",{staticClass:"col-xs-12 col-md-6"},[s("div",{staticClass:"row"},[s("q-input",{staticClass:"col-10",attrs:{tabindex:"4",dense:"",label:"Email "+(i+1),outlined:"",square:"","error-message":e.emails_errors[i].message,error:e.emails_errors[i].message.length>0},on:{input:e.validateEmails},model:{value:e.emails[i].content,callback:function(t){e.$set(e.emails[i],"content",t)},expression:"emails[index].content"}}),s("div",{staticClass:"col-2"},[e.emails.length>1?s("q-btn",{staticClass:"q-mt-sm",attrs:{icon:"delete",round:"",flat:""},on:{click:function(t){e.emails.splice(i,1),e.emails_errors.splice(i,1)}}}):e._e()],1)],1)])])})),s("div",{staticClass:"row"},[s("q-btn",{attrs:{color:"secondary",label:"Add Email",flat:""},on:{click:function(t){e.emails.push({id:e.emails.length+1,content:""}),e.emails_errors.push({message:""})}}})],1),e.isLead?e._e():s("div",{staticClass:"row"},[s("q-toggle",{attrs:{label:"Non Billable Account"},model:{value:e.non_billable_account,callback:function(t){e.non_billable_account=t},expression:"non_billable_account"}})],1),e.non_billable_account?e._e():s("div",{staticClass:"text-subtitle1 q-mt-md"},[e._v(" Billing Address")]),e.non_billable_account?e._e():s("div",[s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-xs-12 col-md-6"},[s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},[s("q-input",{ref:"billing_address_line_1",attrs:{tabindex:"5",square:"",outlined:"",dense:"",label:"Line 1",rules:[function(t){return!(!e.isLead&&!t)||"Required"}],"lazy-rules":"ondemand"},on:{blur:function(t){e.billing_address.line_1=e.capitaliseFn(e.billing_address.line_1)}},model:{value:e.billing_address.line_1,callback:function(t){e.$set(e.billing_address,"line_1",t)},expression:"billing_address.line_1"}})],1)])]),s("div",{staticClass:"col-xs-12 col-md-6"},[s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{tabindex:"6",square:"",dense:"",outlined:"",label:"Line 2"},on:{blur:function(t){e.billing_address.line_2=e.capitaliseFn(e.billing_address.line_2)}},model:{value:e.billing_address.line_2,callback:function(t){e.$set(e.billing_address,"line_2",t)},expression:"billing_address.line_2"}})],1)])])]),s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-xs-12 col-md-3"},[s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},[s("q-input",{ref:"billing_address_pin",attrs:{dense:"",square:"",outlined:"",label:"Pin / Zip Code",rules:[e.billingPinRule],"lazy-rules":"ondemand",tabindex:"7"},model:{value:e.billing_address.pin,callback:function(t){e.$set(e.billing_address,"pin",t)},expression:"billing_address.pin"}})],1)])]),s("div",{staticClass:"col-xs-12 col-md-3"},[s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},[s("q-select",{ref:"billing_address_country",attrs:{"use-input":"","fill-input":"",dense:"","hide-selected":"",square:"",outlined:"",options:e.country_options,rules:[function(t){return!(!e.isLead&&!t)||"Required"}],"lazy-rules":"ondemand",label:"Country",tabindex:"8"},on:{filter:e.countryfilterFn,input:e.loadBillingState},model:{value:e.billing_address.country,callback:function(t){e.$set(e.billing_address,"country",t)},expression:"billing_address.country"}})],1)])]),s("div",{staticClass:"col-xs-12 col-md-3"},[s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},[s("q-select",{ref:"billing_address_state",attrs:{square:"",dense:"",outlined:"",disable:!e.billing_address.country,options:e.states,rules:[function(t){return!(!e.isLead&&!t)||"Required"}],"lazy-rules":"ondemand",loading:e.billing_address_state_loading,label:"State",tabindex:"9"},on:{input:e.loadBillingDistrict},model:{value:e.billing_address.state,callback:function(t){e.$set(e.billing_address,"state",t)},expression:"billing_address.state"}})],1)])]),s("div",{staticClass:"col-xs-12 col-md-3"},[s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},["India"!=e.billing_address.country?s("q-input",{ref:"billing_address_district",attrs:{square:"",outlined:"",dense:"",label:"District",tabindex:"10"},on:{blur:function(t){e.billing_address.district=e.capitaliseFn(e.billing_address.district)}},model:{value:e.billing_address.district,callback:function(t){e.$set(e.billing_address,"district",t)},expression:"billing_address.district"}}):s("q-select",{ref:"billing_address_district",attrs:{dense:"",square:"",outlined:"",disable:!e.billing_address.state,rules:[e.billingDistrictRule],"lazy-rules":"ondemand",options:e.districts,loading:e.billing_address_district_loading,label:"District",tabindex:"11"},model:{value:e.billing_address.district,callback:function(t){e.$set(e.billing_address,"district",t)},expression:"billing_address.district"}})],1)])])]),e._l(e.billing_address.phones,(function(t,i){return s("div",{key:i,staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-xs-12 col-md-6"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-3"},[s("q-select",{attrs:{options:e.phonecodes,"emit-value":"",dense:"",outlined:"",square:"",label:"Code"},model:{value:e.billing_address.phones[i].country_code,callback:function(t){e.$set(e.billing_address.phones[i],"country_code",t)},expression:"billing_address.phones[index].country_code"}})],1),s("q-input",{ref:"billing_phone_"+i,refInFor:!0,staticClass:"col-7",attrs:{tabindex:"12",label:"Phone "+(i+1),outlined:"",dense:"",square:"","error-message":e.billing_address_phones_errors[i].message,error:e.billing_address_phones_errors[i].message.length>0},on:{input:e.validateBillingPhones},model:{value:e.billing_address.phones[i].content,callback:function(t){e.$set(e.billing_address.phones[i],"content",t)},expression:"billing_address.phones[index].content"}}),s("div",{staticClass:"col-2"},[e.billing_address.phones.length>1?s("q-btn",{staticClass:"q-mt-sm",attrs:{icon:"delete",round:"",flat:""},on:{click:function(t){e.billing_address.phones.splice(i,1),e.billing_address_phones_errors.splice(i,1)}}}):e._e()],1)],1)])])})),s("q-btn",{attrs:{color:"secondary",label:"Add Phone",flat:""},on:{click:e.addBillingPhone}}),e.isLead?e._e():s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-subtitle1 q-mt-md"},[e._v(" Shipping Address(es)")]),e.shipping_addresses.length>0?s("q-markup-table",[s("thead",[s("th",{staticClass:"text-left"},[e._v("Default")]),s("th",[e._v("Address")]),s("th")]),s("tbody",e._l(e.shipping_addresses,(function(t,i){return s("tr",{key:i},[s("td",[s("q-radio",{attrs:{val:t.id},model:{value:e.default_shipping,callback:function(t){e.default_shipping=t},expression:"default_shipping"}})],1),s("td",[s("div",{staticClass:"text-subtitle1"},[e._v(e._s(e.addressFormat(t)))])]),s("td",[s("q-btn",{attrs:{round:"",flat:"",icon:"edit"},on:{click:function(t){return e.editAddress(i)}}}),s("q-btn",{attrs:{round:"",flat:"",icon:"delete"},on:{click:function(t){return e.deleteAddress(i)}}})],1)])})),0)]):e._e(),s("q-btn",{staticClass:"q-mt-md",attrs:{color:"secondary",label:"Add Shipping Address"},on:{click:e.openShippingDialog}}),s("q-btn",{staticClass:"q-mt-md",attrs:{color:"secondary",flat:"",tabindex:"13",label:"Copy Billing Address"},on:{click:e.duplicateBilling}})],1)])],2),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-subtitle1 q-mt-md"},[e._v(" Linked Accounts")]),e._l(e.linked_accounts,(function(t,i){return s("div",{key:i,staticClass:"row q-col-gutter-sm"},[s("div",{staticClass:"col"},[s("q-select",{attrs:{label:"Relation Type",options:e.relationOptions,outlined:"",square:""},model:{value:e.linked_accounts[i].relation_type,callback:function(t){e.$set(e.linked_accounts[i],"relation_type",t)},expression:"linked_accounts[i].relation_type"}})],1),s("div",{staticClass:"col"},[s("q-select",{attrs:{"use-input":"",disable:null==e.linked_accounts[i].relation_type,outlined:"",square:"",dense:"",label:"Search Customer","option-value":"id","option-label":"name",options:e.customerOptions},on:{filter:function(t,s,a){e.customerFilterFn(t,s,a,i)}},scopedSlots:e._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[e._v("\n                                            No results\n                                            ")])],1)]},proxy:!0}],null,!0),model:{value:e.linked_accounts[i].account,callback:function(t){e.$set(e.linked_accounts[i],"account",t)},expression:"linked_accounts[i].account"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{dense:"",label:"Specify Relation",outlined:"",square:""},model:{value:e.linked_accounts[i].specification,callback:function(t){e.$set(e.linked_accounts[i],"specification",t)},expression:"linked_accounts[i].specification"}})],1),s("div",{staticClass:"col-1"},[s("q-btn",{attrs:{round:"",flat:"",icon:"delete"},on:{click:function(t){return e.linked_accounts.splice(i,1)}}})],1)])}))],2)]),s("q-btn",{attrs:{flat:"",color:"primary",label:"Add Relation"},on:{click:function(t){return e.linked_accounts.push({relation_type:null,account:null,specification:null})}}})],2)],1)],1),s("q-dialog",{attrs:{"full-width":"",persistent:""},model:{value:e.shippingDialog,callback:function(t){e.shippingDialog=t},expression:"shippingDialog"}},[s("q-card",[s("q-bar",{attrs:{dark:""}},[s("q-space"),s("q-btn",{attrs:{dense:"",flat:"",icon:"close"},on:{click:e.closeShippigDialog}},[s("q-tooltip",[e._v("Close")])],1)],1),s("q-card-section",[s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-xs-12 col-md-6"},[s("div",{staticClass:"row q-mt-md"},[s("div",{staticClass:"col"},[s("q-input",{ref:"shipping_address_line_1",attrs:{square:"",outlined:"",dense:"",label:"Line 1",rules:[function(e){return!!e||"Required"}],"lazy-rules":"ondemand"},on:{blur:function(t){e.shipping_address.line_1=e.capitaliseFn(e.shipping_address.line_1)}},model:{value:e.shipping_address.line_1,callback:function(t){e.$set(e.shipping_address,"line_1",t)},expression:"shipping_address.line_1"}})],1)])]),s("div",{staticClass:"col-xs-12 col-md-6"},[s("div",{staticClass:"row q-mt-md"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{dense:"",square:"",outlined:"",label:"Line 2"},on:{blur:function(t){e.shipping_address.line_2=e.capitaliseFn(e.shipping_address.line_2)}},model:{value:e.shipping_address.line_2,callback:function(t){e.$set(e.shipping_address,"line_2",t)},expression:"shipping_address.line_2"}})],1)])])]),s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-xs-12 col-md-3"},[s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},[s("q-input",{ref:"shipping_address_pin",attrs:{square:"",outlined:"",dense:"",label:"Pin / Zip Code",rules:[e.shippingPinRule],"lazy-rules":"ondemand"},model:{value:e.shipping_address.pin,callback:function(t){e.$set(e.shipping_address,"pin",t)},expression:"shipping_address.pin"}})],1)])]),s("div",{staticClass:"col-xs-12 col-md-3"},[s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},[s("q-select",{ref:"shipping_address_country",attrs:{"use-input":"","fill-input":"","hide-selected":"",dense:"",square:"",outlined:"",options:e.country_options,rules:[function(e){return!!e||"Required"}],"lazy-rules":"ondemand","option-label":"name","option-value":"id",label:"Country"},on:{filter:e.countryfilterFn,input:e.loadShippingState},model:{value:e.shipping_address.country,callback:function(t){e.$set(e.shipping_address,"country",t)},expression:"shipping_address.country"}})],1)])]),s("div",{staticClass:"col-xs-12 col-md-3"},[s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},[s("q-select",{ref:"shipping_address_state",attrs:{square:"",dense:"",outlined:"",options:e.states,loading:e.shipping_address_state_loading,rules:[function(e){return!!e||"Required"}],"lazy-rules":"ondemand",label:"State"},on:{input:e.loadShippingDistrict},model:{value:e.shipping_address.state,callback:function(t){e.$set(e.shipping_address,"state",t)},expression:"shipping_address.state"}})],1)])]),s("div",{staticClass:"col-xs-12 col-md-3"},[s("div",{staticClass:"row q-mt-xs"},[s("div",{staticClass:"col"},["India"!=e.shipping_address.country?s("q-input",{ref:"shipping_address_district",attrs:{square:"",dense:"",outlined:"",label:"District"},on:{blur:function(t){e.shipping_address.district=e.capitaliseFn(e.shipping_address.district)}},model:{value:e.shipping_address.district,callback:function(t){e.$set(e.shipping_address,"district",t)},expression:"shipping_address.district"}}):s("q-select",{ref:"shipping_address_district",attrs:{square:"",dense:"",outlined:"",rules:[e.shippingDistrictRule],"lazy-rules":"ondemand",options:e.districts,loading:e.shipping_address_district_loading,label:"District"},model:{value:e.shipping_address.district,callback:function(t){e.$set(e.shipping_address,"district",t)},expression:"shipping_address.district"}})],1)])])]),e._l(e.shipping_address.phones,(function(t,i){return s("div",{key:i,staticClass:"row q-col-gutter-md "},[s("div",{staticClass:"col-xs-12 col-md-6"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-3"},[s("q-select",{attrs:{options:e.phonecodes,"emit-value":"",dense:"",outlined:"",square:"",label:"Code"},model:{value:e.shipping_address.phones[i].country_code,callback:function(t){e.$set(e.shipping_address.phones[i],"country_code",t)},expression:"shipping_address.phones[index].country_code"}})],1),s("q-input",{ref:"shipping_phone_"+i,refInFor:!0,staticClass:"col-7",attrs:{label:"Phone "+(i+1),outlined:"",dense:"",square:"","error-message":e.shipping_address_phones_errors[i].message,error:e.shipping_address_phones_errors[i].message.length>0},on:{input:e.validateShippingPhones},model:{value:e.shipping_address.phones[i].content,callback:function(t){e.$set(e.shipping_address.phones[i],"content",t)},expression:"shipping_address.phones[index].content"}}),s("div",{staticClass:"col-2"},[e.shipping_address.phones.length>1?s("q-btn",{staticClass:"q-mt-sm",attrs:{icon:"delete",round:"",flat:""},on:{click:function(t){e.shipping_address.phones.splice(i,1),e.shipping_address_phones_errors.splice(i,1)}}}):e._e()],1)],1)])])})),s("q-btn",{attrs:{color:"secondary",label:"Add Phone",flat:""},on:{click:function(t){return e.addShippingPhone()}}})],2),s("q-card-actions",[s("q-btn",{attrs:{label:"Submit",color:"green"},on:{click:e.addShipping}})],1)],1)],1),s("page-toolbar",{staticClass:"q-mt-md",attrs:{"page-title":"",buttons:e.toolbarButtons},on:{save:function(t){return e.saveFn()},activate:function(t){return e.activate()},sendforapproval:e.sendforapproval}})],1)},a=[],n=(s("c975"),s("fb6a"),s("a434"),s("e6cf"),s("a79d"),s("498a"),s("ddb0"),s("a89c")),l=s("b6c6"),r={name:"CustomerForm",components:{PageToolbar:n["a"],Breadcrumbs:l["a"]},props:{isLead:{type:Boolean,default:!1}},data(){return{name:null,type:null,status:"Draft",type_options:[],gst_number:"",gst_error_message:"",has_gst:!1,errors:{name:""},emails:[{id:1,content:""}],emails_errors:[{message:""}],billing_address:{line_1:null,line_2:null,pin:null,district:null,state:null,country:"",phones:[{id:1,content:"",country_code:"+91"}]},billing_address_district_loading:!1,billing_address_state_loading:!1,billing_address_phones_errors:[{message:""}],shipping_address:{line_1:null,line_2:null,pin:null,district:null,state:null,country:"",phones:[{id:1,content:"",country_code:"+91"}]},shipping_address_district_loading:!1,shipping_address_state_loading:!1,shipping_address_phones_errors:[{message:""}],default_shipping:null,district_options:[],state_options:[],country_options:[],shipping_addresses:[],countries:[],phonecodes:[],states:[],districts:[],shippingDialog:!1,address_ids_to_delete:[],edit_address_index:null,linked_accounts:[],customerOptions:[],customerSearch:null,non_billable_account:!1,representatives:[],representativeOptions:[],tags:[],tagOptions:[],remarks:"",initial_balance:0}},computed:{breadcrumbs(){const e=[{label:"Dashboard",link:"/"},{label:this.isLead?"Leads":"Customers",link:this.isLead?"/leads":"/customers"},{label:this.$route.params.id?this.name:"Create",link:this.isLead?"/leads/view/"+this.$route.params.id:"/customers/view/"+this.$route.params.id}];return this.$route.params.id&&e.push({label:"Edit",link:""}),e},relationOptions(){return["Works here","Sibling branch of","Owner of","Related to","Works at","Belongs to"]},toolbarButtons(){const e=[];return this.isLead?e.push({label:"Save",id:"save",type:"button",color:"teal",icon:"save"}):(this.$store.getters.hasPermissionTo("activate_customer")&&e.push({label:"Activate and Save",id:"activate",type:"button",color:"green-10",icon:"check"}),e.push({label:"Save as Draft",id:"save",type:"button",color:"teal",icon:"save"}),e.push({label:"Send for Approval",id:"sendforapproval",type:"button",color:"orange-10",icon:"pan_tool"})),e},getTitle(){let e="";return this.$route.params.id?e+="Edit: "+this.name:this.isLead?e+="Create Lead":e+="Create Customer",e},getTypeLabel(){return this.isLead?"Lead Type":"Customer Type"}},mounted(){this.$store.getters.hasPermissionTo("create_customer")?(this.$q.loading.show(),this.billing_address.country="India",this.loadBillingState(),Promise.all([this.$axios.get("countries").then((e=>{this.countries=e.data})),this.$axios.get("phonecodes").then((e=>{this.phonecodes=e.data})),this.$axios.get("representatives").then((e=>{this.representativeOptions=e.data})),this.$axios.get("customers/types").then((e=>{this.type_options=e.data}))]).then((()=>{this.$route.params.id&&this.$axios.get("customers/"+this.$route.params.id).then((e=>{this.status=e.data.status,this.name=e.data.name,this.has_gst=e.data.has_gst,this.type=e.data.type,this.gst_number=e.data.gst_number,this.default_shipping=e.data.default_shipping,this.initial_balance=e.data.initial_balance;const t=[];this.non_billable_account=e.data.non_billable_account,e.data.emails.forEach((e=>{this.emails_errors.push({message:""}),t.push({id:e.id,content:e.content})})),t.length>0&&(this.emails=t),e.data.addresses.forEach((e=>{if("billing"===e.tag_name){const t=[];e.phones.forEach((e=>{this.billing_address_phones_errors.push({message:""}),t.push({id:e.id,content:e.content,country_code:e.country_code})})),this.billing_address={line_1:e.line_1,line_2:e.line_2,pin:e.pin,country:e.country,state:e.state,district:e.district,phones:t}}if("shipping"===e.tag_name){const t=[];e.phones.forEach((e=>{this.shipping_address_phones_errors.push({message:""}),t.push({id:e.id,content:e.content,country_code:e.country_code})})),this.shipping_addresses.push({id:e.id,line_1:e.line_1,line_2:e.line_2,pin:e.pin,country:e.country,state:e.state,district:e.district,phones:t})}})),e.data.linked.forEach((e=>{this.linked_accounts.push({relation_type:e.pivot.relation_type,account:{id:e.id,name:e.name},specification:e.pivot.specification})})),e.data.tags.forEach((e=>{this.tags.push(e.content)})),this.representatives=Object.keys(this.$_.groupBy(e.data.representatives,"id")).map((e=>parseInt(e,10)))}))})).finally((()=>{this.$nextTick((()=>{this.$store.commit("setPageTitle",this.getTitle)})),this.$refs.type.focus(),this.$q.loading.hide()}))):this.$router.push({name:"Error403"})},methods:{countryfilterFn(e,t,s){t((()=>{const t=e.toLocaleLowerCase();this.country_options=this.countries.filter((e=>e.toLocaleLowerCase().indexOf(t)>-1))}))},addressFormat(e){let t="";return t+=e.line_1+", ",e.line_2&&(t+=e.line_2+", "),e.district&&(t+=e.district+", "),e.pin&&(t+="PIN: "+e.pin+", "),t+=e.state+", ",t+=e.country+", ",e.phones.forEach((e=>{t+="("+e.country_code+")"+e.content+", "})),t=t.substr(0,t.length-2),t},openShippingDialog(){this.shipping_address.country="India",this.loadShippingState(),this.shippingDialog=!0},closeShippigDialog(){this.billing_address.state||(this.loadBillingState(),this.loadBillingDistrict()),this.resetShippingPhonesErrors(),this.resetShippingAddress(),this.edit_address_index=null,this.shippingDialog=!1},addShipping(){if(this.$refs.shipping_address_line_1.validate()&this.$refs.shipping_address_pin.validate()&this.$refs.shipping_address_country.validate()&this.$refs.shipping_address_state.validate()&this.$refs.shipping_address_district.validate()&this.validateShippingPhones()){const e=this.$_.cloneDeep(this.shipping_address);null!=this.edit_address_index?this.shipping_addresses[this.edit_address_index]=e:(e.id="temp_"+this.shipping_addresses.length+1,this.shipping_addresses.push(e)),this.closeShippigDialog()}},resetShippingAddress(){this.shipping_address.line_1=null,this.shipping_address.line_2=null,this.shipping_address.pin=null,this.shipping_address.district="",this.shipping_address.district_loading=!1,this.shipping_address.state=null,this.shipping_address.state_loading=!1,this.shipping_address.country="",this.shipping_address.phones=[{id:1,content:"",country_code:"+91"}],this.shippingDialog=!1},billingPinRule(e){return"India"!==this.billing_address.country||(this.isLead||e?e&&isNaN(e)?"PIN must be numeric":!e||6===e.length||"PIN must be exactly 6 digits":"Required")},shippingPinRule(e){return"India"!==this.shipping_address.country||(e?isNaN(e)?"PIN must be numeric":6===e.length||"PIN must be exactly 6 digits":"Required")},billingDistrictRule(e){if("India"===this.billing_address.country){if(this.isLead&&this.billing_address_state)return"Required";if(!this.isLead)return e&&e.length>0||"Required"}return!0},shippingDistrictRule(e){return"India"!==this.shipping_address.country||(e&&e.length>0||"Required")},resetShippingPhonesErrors(){this.shipping_address_phones_errors.forEach(((e,t)=>{this.$set(this.shipping_address_phones_errors[t],"message","")}))},resetBillingPhonesErrors(){this.billing_address_phones_errors.forEach(((e,t)=>{this.$set(this.billing_address_phones_errors[t],"message","")}))},resetEmails(){this.emails_errors.forEach(((e,t)=>{this.$set(this.emails_errors[t],"message","")}))},validateShippingPhones(){this.resetShippingPhonesErrors();let e=!1;return this.shipping_address.phones.forEach(((t,s)=>{"India"===this.shipping_address.country?t.content?isNaN(t.content)?(this.$set(this.shipping_address_phones_errors[s],"message","Phone must be numeric."),e=!1):10!==t.content.length?(this.$set(this.shipping_address_phones_errors[s],"message","Phone must be 10 digits."),e=!1):e=!0:(this.$set(this.shipping_address_phones_errors[s],"message","Required"),e=!1):t.content?isNaN(t.content)?(this.$set(this.shipping_address_phones_errors[s],"message","Phone must be numeric."),e=!1):e=!0:(this.$set(this.shipping_address_phones_errors[s],"message","Required"),e=!1)})),e},validateBillingPhones(){this.resetBillingPhonesErrors();let e=!1;return this.billing_address.phones.forEach(((t,s)=>{"India"===this.billing_address.country?t.content?isNaN(t.content)?(this.$set(this.billing_address_phones_errors[s],"message","Phone must be numeric."),e=!1):10!==t.content.length?(this.$set(this.billing_address_phones_errors[s],"message","Phone must be 10 digits."),e=!1):e=!0:(this.$set(this.billing_address_phones_errors[s],"message","Required"),e=!1):t.content?isNaN(t.content)?(this.$set(this.billing_address_phones_errors[s],"message","Phone must be numeric."),e=!1):e=!0:(this.$set(this.billing_address_phones_errors[s],"message","Required"),e=!1)})),e},validateEmails(){let e=!1;this.resetEmails();const t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return this.emails.forEach(((s,i)=>{s.content&&(t.test(String(s.content).toLowerCase())?e=!0:(this.$set(this.emails_errors[i],"message","Invalid Email"),e=!1)),e=!0})),e},validateGst(){return this.gst_error_message="",!(this.has_gst&&this.gst_number.length<1)||(this.gst_error_message="Required",!1)},validateShippingCount(){return!!this.isLead||(this.shipping_addresses.length>0||(this.$q.notify({type:"negative",message:"There Should be atleast one shipping address"}),!1))},sendforapproval(){this.saveFn("Pending Approval")},activate(){this.saveFn("Active")},saveFn(e="Draft"){if(this.validateFn(e)){this.errors.name="",this.emails_errors.forEach(((e,t)=>{this.emails_errors[t].message=""})),this.billing_address_phones_errors.forEach(((e,t)=>{this.billing_address_phones_errors[t].message=""}));const t={is_lead:this.isLead?1:0,_method:this.$route.params.id?"PUT":"POST",status:this.isLead?this.status:e,type:this.type,address_ids_to_delete:this.address_ids_to_delete,linked_accounts:JSON.stringify(this.linked_accounts),representatives:this.representatives,tags:this.tags,remarks:this.remarks,initial_balance:this.initial_balance};if(!this.isLead){const e=Object.keys(this.$_.groupBy(this.shipping_addresses,"id"));e.includes(this.default_shipping)?t.default_shipping=this.default_shipping:t.default_shipping=this.non_billable_account?0:this.shipping_addresses[0].id}t.name=this.name,t.gst_number=this.has_gst?this.gst_number:"",t.has_gst=this.has_gst,t.non_billable_account=this.non_billable_account,t.billing_address=this.billing_address,t.emails=this.emails,t.shipping_addresses=this.shipping_addresses;let s="customers";this.$route.params.id&&(s="customers/"+this.$route.params.id),this.$q.loading.show(),this.$axios.post(s,t).then((e=>{"success"===e.data.message&&(this.$q.loading.hide(),this.$q.notify({type:"positive",message:"Saved Succesfully."}),this.$router.back())})).catch((e=>{this.$q.loading.hide(),422===e.response.status&&(this.$q.notify({type:"negative",message:e.response.data.message}),Object.keys(e.response.data.errors).forEach(((t,s)=>{-1!==t.indexOf("emails")?this.emails_errors[Number(t.substr(t.indexOf("emails")+7))].message=e.response.data.errors[t][0]:-1!==t.indexOf("name")?this.errors.name=e.response.data.errors[t][0]:-1!==t.indexOf("billing_address.phones")?this.billing_address_phones_errors[Number(t.substr(t.indexOf("billing_address.phones")+23))].message=e.response.data.errors[t][0]:-1!==t.indexOf("gst_number")&&(this.gst_error_message=e.response.data.errors[t][0])})))})).finally((()=>{this.$q.loading.hide()}))}else this.$q.notify({type:"negative",message:"The form is incomplete. Please verify"})},validateFn(e){return this.non_billable_account?this.$refs.name.validate()&this.$refs.type.validate()&this.validateEmails()&this.validateGst():"Draft"===e?this.$refs.name.validate()&this.$refs.type.validate()&this.$refs.initial_balance.validate()&this.validateBillingPhones()&this.validateEmails()&this.validateGst():this.$refs.name.validate()&this.$refs.initial_balance.validate()&this.$refs.representative.validate()&this.$refs.billing_address_line_1.validate()&this.$refs.billing_address_pin.validate()&this.$refs.billing_address_country.validate()&this.$refs.billing_address_state.validate()&this.$refs.billing_address_district.validate()&this.$refs.type.validate()&this.validateBillingPhones()&this.validateEmails()&this.validateGst()&this.validateShippingCount()},duplicateBilling(){if(this.$refs.billing_address_line_1.validate()&this.$refs.billing_address_pin.validate()&this.$refs.billing_address_country.validate()&this.$refs.billing_address_state.validate()&this.$refs.billing_address_district.validate()&this.validateBillingPhones()){const e=this.$_.cloneDeep(this.billing_address);e.id="temp_"+this.shipping_addresses.length+1,this.shipping_addresses.push(e)}else this.$q.notify({type:"negative",message:"Please fill up billing address completely"})},loadBillingState(){this.billing_address.state=null,this.billing_address.district=null,this.billing_address_state_loading=!0,this.getStates(this.billing_address.country).finally((()=>{this.billing_address_state_loading=!1}))},loadShippingState(e=1){e&&(this.shipping_address.state=null,this.shipping_address.district=null),this.shipping_address_state_loading=!0,this.getStates(this.shipping_address.country).finally((()=>{this.shipping_address_state_loading=!1}))},getStates(e){return this.$axios.get("states/"+encodeURIComponent(e)).then((e=>{this.states=e.data}))},loadBillingDistrict(){this.billing_address.state&&(this.billing_address.district=null,this.billing_address_district_loading=!0,this.getDistricts(this.billing_address.state).finally((()=>{this.billing_address_district_loading=!1})))},loadShippingDistrict(e=1){e&&(this.shipping_address.district=null),this.shipping_address_district_loading=!0,this.getDistricts(this.shipping_address.state).finally((()=>{this.shipping_address_district_loading=!1}))},getDistricts(e){return this.$axios.get("districts/"+encodeURIComponent(e)).then((e=>{this.districts=e.data}))},editAddress(e){this.edit_address_index=e,this.shipping_address=this.$_.cloneDeep(this.shipping_addresses[e]),this.loadShippingState(0),this.loadShippingDistrict(0),this.shippingDialog=!0},addBillingPhone(){this.billing_address.phones.push({id:this.billing_address.phones.length+1,content:"",country_code:"+91"}),this.billing_address_phones_errors.push({message:""}),this.$nextTick((()=>{const e=this.billing_address.phones.length-1,t="billing_phone_"+e;this.$refs[t][0].focus()}))},addShippingPhone(){this.shipping_address.phones.push({id:this.shipping_address.phones.length+1,content:"",country_code:"+91"}),this.shipping_address_phones_errors.push({message:""}),this.$nextTick((()=>{const e=this.shipping_address.phones.length-1,t="shipping_phone_"+e;this.$refs[t][0].focus()}))},deleteAddress(e){this.$q.dialog({title:"Confirm",message:"Are you sure want to delete this record?",cancel:!0,persistent:!0}).onOk((()=>{this.$route.params.id&&this.address_ids_to_delete.push(this.shipping_addresses[e].id),this.shipping_addresses.splice(e,1)})).onCancel((()=>{}))},customerFilterFn(e,t,s,i){t((()=>{if(e){let t="";this.$route.params.id&&(t+="&except_id="+this.$route.params.id),"Sibling branch of"===this.linked_accounts[i].relation_type&&(t+="&type="+this.type),this.$axios.get("customers_search?"+t+"&search="+encodeURIComponent(e)+"&relation_type="+encodeURIComponent(this.linked_accounts[i].relation_type)).then((e=>{this.customerOptions=e.data}))}}))},tagFilterFn(e,t,s,i){t((()=>{if(e){const t="";this.$axios.get("tag_search?"+t+"&search="+encodeURIComponent(e)).then((e=>{this.tagOptions=e.data}))}}))},newTag(e,t){if(e.length>0){const s=(this.tags||[]).slice();e.split(/[,;|]+/).map((e=>e.trim())).filter((e=>e.length>0)).forEach((e=>{!1===s.includes(e)&&s.push(this.capitaliseFn(e))})),t(null),this.tags=s}},linkAccount(){this.customerSearch&&this.linked_accounts.push(this.customerSearch),this.customerSearch=null,this.$nextTick((()=>{window.scrollTo(0,document.body.scrollHeight)}))},capitaliseFn(e){if(e){const t=e.split(" ");for(let e=0;e<t.length;e++)t[e]=t[e].charAt(0).toUpperCase()+t[e].substring(1);return t.join(" ")}return""}},watch:{has_gst(e,t){t&&(this.gst_error_message="",this.gst_number="")},type(e,t){this.$route.params.id||"Doctor"===e&&(this.name="Dr. "+(this.name?this.name:""))}}},o=r,d=s("2877"),c=s("9989"),u=s("f09f"),p=s("a370"),h=s("ddd8"),g=s("27f9"),_=s("8f8e"),m=s("66e5"),b=s("4074"),f=s("d66b"),v=s("9c40"),y=s("9564"),q=s("2bb1"),x=s("3786"),C=s("24e8"),k=s("d847"),$=s("2c91"),w=s("05c0"),S=s("4b7e"),D=s("eebe"),P=s.n(D),F=Object(d["a"])(o,i,a,!1,null,null,null);t["a"]=F.exports;P()(F,"components",{QPage:c["a"],QCard:u["a"],QCardSection:p["a"],QSelect:h["a"],QInput:g["a"],QCheckbox:_["a"],QItem:m["a"],QItemSection:b["a"],QEditor:f["a"],QBtn:v["a"],QToggle:y["a"],QMarkupTable:q["a"],QRadio:x["a"],QDialog:C["a"],QBar:k["a"],QSpace:$["a"],QTooltip:w["a"],QCardActions:S["a"]})},a89c:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-toolbar",{staticClass:" q-pr-none",style:{background:"rgba(200,200,200,0.5)"}},[s("div",{staticClass:"row col self-stretch"},[s("div",{staticClass:"col-12 justify-end row"},[e.$q.screen.gt.sm?s("q-btn",{staticClass:"self-stretch",staticStyle:{"border-radius":"0"},attrs:{icon:"arrow_back",flat:"",label:"Back",color:"teal-9"},on:{click:function(t){return e.$router.back()}}}):e._e(),e._l(e.buttons,(function(t){return[s("q-btn",{key:t.label,class:e.$q.screen.gt.sm?"q-ml-sm":"q-ml-sm q-mt-sm",staticStyle:{"border-radius":"0"},attrs:{color:t.color||"teal","text-color":t.textColor,label:t.label,flat:!!t.flat,tile:"",unelevated:"",icon:t.icon,type:t.type,to:t.link},on:{click:function(s){return e.$emit(t.id)}}})]}))],2)])])},a=[],n={props:{buttons:{type:Array,default:()=>[]}},data(){return{}},methods:{}},l=n,r=s("2877"),o=s("65c6"),d=s("9c40"),c=s("eebe"),u=s.n(c),p=Object(r["a"])(l,i,a,!1,null,null,null);t["a"]=p.exports;u()(p,"components",{QToolbar:o["a"],QBtn:d["a"]})},ab3c:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{class:e.$q.screen.gt.sm?"q-px-lg":"q-px-xs"},[s("q-table",{attrs:{title:"Users",data:e.items,columns:e.columns,"row-key":e.rowKey,dense:e.$q.screen.lt.md,"visible-columns":e.visibleColumns,loading:e.loading,pagination:e.pagination,"rows-per-page-options":[10,20,50,100]},on:{"update:pagination":function(t){e.pagination=t},request:e.getDataFromApi},scopedSlots:e._u([{key:"loading",fn:function(){return[s("q-inner-loading",{attrs:{showing:""}},[s("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1)]},proxy:!0},{key:"top",fn:function(t){return[s("div",{staticClass:"row",staticStyle:{width:"100%"}},[s("div",{staticClass:"col-xs-12 col-md-6"},[s("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Search here..",square:"",clearable:""},on:{keyup:[function(t){e.autoSearch&&e.debouncedSearch()},function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;!e.autoSearch&&(e.search?e.getDataFromApi({pagination:{page:1,rowsPerPage:e.pagination.rowsPerPage,sortBy:e.pagination.sortBy,descending:e.pagination.descending},filter:e.search}):e.getDataFromApi({pagination:{page:1,rowsPerPage:e.pagination.rowsPerPage,sortBy:e.pagination.sortBy,descending:e.pagination.descending},filter:e.search,clear_search:1}))}],clear:function(t){return e.getDataFromApi({pagination:{page:1,rowsPerPage:e.pagination.rowsPerPage,sortBy:e.pagination.sortBy,descending:e.pagination.descending},filter:e.search,clear_search:1})}},scopedSlots:e._u([{key:"append",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!0),model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),s("div",{staticClass:"col-xs-12 col-md-6",staticStyle:{display:"flex","justify-content":"flex-end"}},[s("q-btn",{attrs:{flat:"",round:"",icon:"refresh",color:"green-10"},on:{click:function(t){return e.getDataFromApi({pagination:e.pagination,filter:e.search})}}}),s("q-toggle",{attrs:{label:"Auto Search ?"},on:{input:e.changeAutoSearch},model:{value:e.autoSearch,callback:function(t){e.autoSearch=t},expression:"autoSearch"}}),t.inFullscreen?e._e():s("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"filter_alt"},on:{click:function(t){e.filterDrawer=!e.filterDrawer}}},[s("q-tooltip",[e._v("\n                Filter\n              ")])],1),t.inFullscreen?s("q-select",{staticClass:"q-mx-md",attrs:{options:e.columns,multiple:"","emit-value":"","map-options":"","option-value":"name",outlined:"",dense:"","options-dense":"","display-value":"Columns"},on:{input:e.changeVisibleColumns},model:{value:e.visibleColumns,callback:function(t){e.visibleColumns=t},expression:"visibleColumns"}}):s("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"visibility"},on:{click:function(t){e.visibilityDrawer=!e.visibilityDrawer}}},[s("q-tooltip",[e._v("\n                Visible Columns\n              ")])],1),s("q-btn",{staticClass:"q-ml-md",attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}},[s("q-tooltip",[e._v("\n                Fullscreen\n              ")])],1)],1)]),s("div",{staticClass:"row q-mt-md"},[s("div",{staticClass:"q-gutter-xs"},[e._l(Object.keys(e.filtered),(function(t,i){return[-1!=e.filtered[t].constructor.toString().indexOf("Object")?s("q-chip",{key:i+"a",attrs:{removable:"",color:"primary","text-color":"white"},on:{remove:function(s){e.deleteFilter(t)}}},[e._v("\n                "+e._s(e.filtered[t].min)+" < "+e._s(t)+" > "+e._s(e.filtered[t].max)+"\n              ")]):-1!=e.filtered[t].constructor.toString().indexOf("Array")?s("q-chip",{key:i+"a",attrs:{removable:"",color:"primary","text-color":"white"},on:{remove:function(s){e.deleteFilter(t)}}},[e._v("\n                "+e._s(t)+": "+e._s(e.filtered[t].toString())+"\n              ")]):s("q-chip",{key:i+"b",attrs:{removable:"",color:"primary","text-color":"white"},on:{remove:function(s){e.deleteFilter(t)}}},[e._v("\n                "+e._s(t)+": "+e._s(e.filtered[t])+"\n              ")])]}))],2)])]}},{key:"body-cell-actions",fn:function(t){return[s("q-td",{attrs:{props:t}},[!e.canEdit||t.row.hasOwnProperty("status")&&"Draft"!=t.row.status?e._e():s("q-btn",{attrs:{round:"",icon:"edit",flat:"",color:"black",to:e.pageEdit?void 0:e.editRoute?e.editRoute+"/edit/"+t.row.id:e.route+"/edit/"+t.row.id},on:{click:function(s){return e.$emit("edit-fn",t.row)}}}),e.canDelete?s("q-btn",{attrs:{round:"",icon:"delete",flat:"",color:"black"},on:{click:function(s){return e.deleteFn(t.row.id)}}}):e._e(),!e.cancel||"Draft"!=t.row.status&&"Pending Confirmation"!=t.row.status?e._e():s("q-btn",{attrs:{round:"",icon:"close",flat:"",color:"black"},on:{click:function(s){return e.cancelFn(t.row.id)}}})],1)]}},{key:"body-cell-status",fn:function(t){return[s("q-td",{key:"status",attrs:{props:t}},[s("q-badge",{staticClass:"q-pa-sm",attrs:{color:e.getStatusColor(t.row.status)}},[e._v("\n            "+e._s(t.row.status)+"\n          ")])],1)]}},{key:"body-cell-erp_status",fn:function(t){return[s("q-td",{key:"erp_status",attrs:{props:t}},[s("q-badge",{staticClass:"q-pa-sm",attrs:{color:e.getStatusColor(t.row.erp_status)}},[e._v("\n            "+e._s(t.row.erp_status)+"\n          ")])],1)]}},{key:"body-cell-payment_status",fn:function(t){return[s("q-td",{key:"payment_status",attrs:{props:t}},[s("q-badge",{staticClass:"q-pa-sm",attrs:{color:e.getStatusColor(t.row.payment_status)}},[e._v("\n            "+e._s(t.row.payment_status)+"\n          ")])],1)]}},{key:"body-cell-shipment_status",fn:function(t){return[s("q-td",{key:"shipment_status",attrs:{props:t}},[t.row.shipment_status?s("q-badge",{staticClass:"q-pa-sm",attrs:{color:e.getStatusColor(t.row.shipment_status)}},[e._v("\n            "+e._s(t.row.shipment_status)+"\n          ")]):e._e()],1)]}},{key:"body-cell",fn:function(t){return[t.col.name==e.link_key?s("q-td",{class:"right"==t.col.align?"text-right":"text-left",attrs:{props:t}},[s("router-link",{staticClass:"text-ble-9u",staticStyle:{"text-decoration":"none","font-weight":"700"},attrs:{to:e.route+"/view/"+t.row.id}},[e._v("\n            "+e._s(t.value)+"\n          ")]),s("q-btn",{attrs:{icon:"content_copy",flat:"",round:""},on:{click:function(s){return e.$store.dispatch("copyToClipboard",t.value)}}})],1):s("q-td",{class:"right"==t.col.align?"text-right":"text-left"},["datetime"==t.col.field_type?[e._v("\n            "+e._s(e.getLocaleString(t.value))+"\n          ")]:"boolean"==t.col.field_type?[e._v("\n            "+e._s(t.value?"Yes":"No")+"\n          ")]:[e._v("\n            "+e._s(t.value)+"\n          ")]],2)]}}])})],1),s("q-drawer",{attrs:{side:"right",breakpoint:700,bordered:"",overlay:"",behavior:"mobile"},model:{value:e.visibilityDrawer,callback:function(t){e.visibilityDrawer=t},expression:"visibilityDrawer"}},[s("q-list",[s("q-item-label",{attrs:{header:""}},[e._v("Visible Columns")]),e._l(e.columns,(function(t,i){return[1!=t.required?s("q-item",{key:i},[s("q-item-section",[s("q-toggle",{attrs:{val:t.field,label:t.label},on:{input:e.changeVisibleColumns},model:{value:e.visibleColumns,callback:function(t){e.visibleColumns=t},expression:"visibleColumns"}})],1)],1):e._e()]}))],2)],1),s("q-drawer",{attrs:{side:"right",breakpoint:700,bordered:"",overlay:"",behavior:"mobile"},model:{value:e.filterDrawer,callback:function(t){e.filterDrawer=t},expression:"filterDrawer"}},[s("q-list",[s("q-item-label",{attrs:{header:""}},[e._v("Filter Options")]),s("q-item",[s("q-item-section",[s("q-btn",{attrs:{label:"Reset All",flat:""},on:{click:function(t){return e.resetFilter()}}}),s("q-btn",{attrs:{label:"Apply",color:"primary"},on:{click:function(t){return e.applyFilter()}}})],1)],1),e._l(e.filterables,(function(t,i){return[s("q-item",{key:i},[s("q-item-section",["Boolean"==t.field_type?s("q-select",{attrs:{options:["","Yes","No"],square:"",outlined:"",dense:"",label:t.name},model:{value:e.filterables[i].value,callback:function(t){e.$set(e.filterables[i],"value",t)},expression:"filterables[i].value"}}):e._e(),"String"==t.field_type?s("q-input",{attrs:{square:"",outlined:"",dense:"",label:t.name},model:{value:e.filterables[i].value,callback:function(t){e.$set(e.filterables[i],"value",t)},expression:"filterables[i].value"}}):e._e(),"Decimal"==t.field_type||"Integer"==t.field_type?s("div",[s("div",{staticClass:"subtitle1"},[e._v(e._s(t.name))]),s("q-range",{attrs:{label:"",min:e.filterables[i].min,max:e.filterables[i].max},model:{value:e.filterables[i].value,callback:function(t){e.$set(e.filterables[i],"value",t)},expression:"filterables[i].value"}})],1):e._e(),"Selection"==t.field_type&&1==t.searcheable?s("q-select",{attrs:{square:"",outlined:"",dense:"",options:e.filterables[i].options,"input-debounce":"300",multiple:"","use-chips":"",label:t.name},on:{filter:function(t,s,a){e.filterFn({val:t,update:s,abort:a},i)}},scopedSlots:e._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[e._v("\n                    No results\n                  ")])],1)]},proxy:!0}],null,!0),model:{value:e.filterables[i].value,callback:function(t){e.$set(e.filterables[i],"value",t)},expression:"filterables[i].value"}}):e._e(),"Selection"==t.field_type&&0==t.searcheable?s("q-select",{attrs:{multiple:0!=e.filterables[i].multiple,square:"",outlined:"",dense:"",options:e.filterables[i].options,label:t.name},scopedSlots:e._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[e._v("\n                    No results\n                  ")])],1)]},proxy:!0}],null,!0),model:{value:e.filterables[i].value,callback:function(t){e.$set(e.filterables[i],"value",t)},expression:"filterables[i].value"}}):e._e()],1)],1)]}))],2)],1)],1)},a=[],n=(s("c975"),s("e6cf"),s("a79d"),s("ddb0"),{name:"advancedDatatable",props:{rowKey:{type:String,default:"name"},route:{type:String,required:!0},pagePreferences:{type:Object,required:!0},editPermission:{type:String,default:""},deletePermission:{type:String,default:""},editRoute:{type:String,default:null},deleteRoute:{type:String,default:null},pageEdit:{type:Boolean,default:!1},updateOnVisibility:{type:Boolean,default:!0},cancel:{type:Boolean,default:!1},noDelete:{type:Boolean,default:!1},cancelRoute:{type:String,default:null}},data(){return{search:null,autoSearch:!1,filterDrawer:!1,visibilityDrawer:!1,items:[],visibleColumns:[],columns:[],loading:!1,canEdit:!1,canDelete:!1,pagination:{rowsNumber:10},link_key:null,filterables:[],filtered:{}}},watch:{},mounted(){this.initState()},methods:{changeVisibleColumns(){this.updateOnVisibility&&this.getDataFromApi({pagination:this.pagination,filter:this.search})},changeAutoSearch(){const e=this.pagePreferences.page_index_autosearch,t={};t[e]=this.autoSearch,this.$axios.post("preferences",t)},deleteFn(e){this.$q.dialog({title:"Confirm",message:"Would you like to delete this record?",cancel:!0,persistent:!0}).onOk((()=>{const t=this.deleteRoute?this.deleteRoute+"/"+e:this.route+"/"+e;this.$axios.post(t,{_method:"DELETE"}).then((e=>{"success"===e.data.message&&this.$q.notify({type:"info",message:"Record deleted from database"})})).finally((()=>{this.getDataFromApi({pagination:this.pagination,filter:this.search})}))})).onCancel((()=>{}))},cancelFn(e){this.$q.dialog({title:"Confirm",message:"Would you like to cancel this record?",cancel:!0,persistent:!0}).onOk((()=>{const t=this.cancelRoute+"/"+e;this.$axios.get(t).then((e=>{"success"===e.data.message&&this.$q.notify({type:"info",message:"Record cancelled"})})).finally((()=>{this.getDataFromApi({pagination:this.pagination,filter:this.search})}))})).onCancel((()=>{}))},initState(){Promise.all([this.$axios.get("preferences?key="+this.pagePreferences.page_index_autosearch).then((e=>{e.data&&(this.autoSearch="1"===e.data.value)})),this.$axios.get(this.route+"/columns").then((e=>{this.columns=e.data,this.canEdit=this.$store.getters.hasPermissionTo(this.editPermission),this.canDelete=this.$store.getters.hasPermissionTo(this.deletePermission)&&!this.noDelete,(this.canEdit||this.canDelete||this.cancel)&&this.columns.push({name:"actions",label:"Actions",field:"actions",required:!0,sortable:!1,align:"right"})})),this.$axios.get(this.route+"/filterables").then((e=>{const t=e.data;t.forEach(((e,s)=>{"Selection"===e.field_type&&e.searcheable&&(t[s].options=[]),"Decimal"===e.field_type||"Integer"===e.field_type?t[s].value={min:parseInt(e.min),max:parseInt(e.max)}:t[s].value=null})),this.$nextTick((()=>{this.filterables=t}))})).catch((e=>{const t=e.response;console.log(t)}))]).finally((()=>{if(this.debouncedSearch=this.$_.debounce((()=>{const e={page:1,rowsPerPage:this.pagination.rowsPerPage,sortBy:this.pagination.sortBy,descending:this.pagination.descending};this.search?this.getDataFromApi({pagination:e,filter:this.search}):this.getDataFromApi({pagination:e,filter:this.search,clear_search:1},!0)}),1e3),this.$route.query.status){const e={status:[this.$route.query.status]};this.$route.query.source&&(e.source=[this.$route.query.source]),this.getDataFromApi({pagination:this.pagination,filter:this.search,filterBy:e},!0)}else if(this.$route.query.source){const e={source:[this.$route.query.source]};this.getDataFromApi({pagination:this.pagination,filter:this.search,filterBy:e},!0)}else this.getDataFromApi({pagination:this.pagination,filter:this.search},!0)}))},triggerExternal(){this.getDataFromApi({pagination:this.pagination,filter:this.search})},getDataFromApi(e,t=!1){this.loading=!0;const{page:s,rowsPerPage:i,sortBy:a,descending:n}=e.pagination,l=e.filter?e.filter:this.search?this.search:"";let r="";-1!==this.route.indexOf("?")?r+=this.route+"&":r+=this.route+"?",t?e.filterBy&&(r+="&filter="+encodeURIComponent(JSON.stringify(e.filterBy))):(r+="page="+s+"&rpp="+i+"&sortby="+(a||"")+"&desc="+n+"&search="+encodeURIComponent(l)+"&visible="+encodeURIComponent(JSON.stringify(this.visibleColumns)),e.filterBy?r+="&filter="+encodeURIComponent(JSON.stringify(e.filterBy)):r+="&filter="+encodeURIComponent(JSON.stringify(this.filtered)),e.filter_deleted&&(r+="&filter_deleted=1"),e.clear_search&&(r+="&clear_search=1")),this.$axios.get(r).then((e=>{this.items=e.data.model.data,this.pagination.rowsNumber=e.data.model.total,this.pagination.page=e.data.model.current_page,this.pagination.rowsPerPage=e.data.model.per_page,this.pagination.sortBy=e.data.sortby,this.pagination.descending=e.data.descending,this.link_key=e.data.link_key,this.visibleColumns=e.data.visible_columns,this.filtered=e.data.filtered,this.search=e.data.search?decodeURIComponent(e.data.search):""})).finally((()=>{this.loading=!1}))},applyFilter(){this.filtered={},this.filterables.forEach(((e,t)=>{"Decimal"===e.field_type||"Integer"===e.field_type?e.value.max===e.max&&e.value.min===e.min||(this.filtered[e.slug]=e.value):e.value?-1!==e.value.constructor.toString().indexOf("Array")?e.value.length>0?this.filtered[e.slug]=e.value:this.$delete(this.filtered,e.slug):this.filtered[e.slug]=e.value:this.$delete(this.filtered,e.slug)})),this.getDataFromApi({pagination:this.pagination,filter:this.search})},deleteFilter(e){this.$delete(this.filtered,e),this.filterables.forEach(((t,s)=>{t.slug===e&&("Decimal"===t.field_type||"Integer"===t.field_type?(this.filterables[s].value.max=parseInt(t.max),this.filterables[s].value.min=parseInt(t.min)):this.filterables[s].value=null)})),this.getDataFromApi({pagination:this.pagination,filter:this.search,filter_deleted:1})},resetFilter(){this.filterables.forEach(((e,t)=>{"Decimal"===e.field_type||"Integer"===e.field_type?(this.filterables[t].value.max=parseInt(e.max),this.filterables[t].value.min=parseInt(e.min)):this.filterables[t].value=null})),this.applyFilter()},filterFn({val:e,update:t,abort:s},i){t((()=>{const t=e.toLowerCase();t&&t.length>0&&this.$axios.get(this.filterables[i].search_link+"?search="+encodeURIComponent(t)).then((e=>{this.filterables[i].options=e.data})).catch((e=>{}))}))},getLocaleString(e){if(e){const t=new Date(e);return t.toLocaleString("en-IN")}return null},getStatusColor(e){return"Draft"===e||"Disabled"===e||"Confirmed"===e||"Draft - Reverted"===e?"grey-9":"Pending Approval"===e||"Rejected"===e||"Pending Activation"===e||"Pending Confirmation"===e||"Cancelled"===e||"pending"===e?"red-10":"Processing"===e||"Awaiting Shipment"===e||"Packed"===e||"Partially Converted"===e|"processing"===e?"orange-9":"Invoice Pending"===e?"blue-10":"Admin Approved"===e||"Approved"===e?"blue":"Invoiced"===e||"Generated"===e?"info":"Active"===e||"Complete"===e||"Converted"===e?"green-10":void 0}}}),l=n,r=s("2877"),o=s("eaac"),d=s("74f7"),c=s("cf57"),u=s("27f9"),p=s("0016"),h=s("9c40"),g=s("9564"),_=s("05c0"),m=s("ddd8"),b=s("b047"),f=s("db86"),v=s("58a81"),y=s("9404"),q=s("1c1c"),x=s("0170"),C=s("66e5"),k=s("4074"),$=s("7bbf"),w=s("eebe"),S=s.n(w),D=Object(r["a"])(l,i,a,!1,null,null,null);t["a"]=D.exports;S()(D,"components",{QTable:o["a"],QInnerLoading:d["a"],QSpinnerGears:c["a"],QInput:u["a"],QIcon:p["a"],QBtn:h["a"],QToggle:g["a"],QTooltip:_["a"],QSelect:m["a"],QChip:b["a"],QTd:f["a"],QBadge:v["a"],QDrawer:y["a"],QList:q["a"],QItemLabel:x["a"],QItem:C["a"],QItemSection:k["a"],QRange:$["a"]})},b456:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-card",{staticStyle:{"min-width":"500px"}},[s("q-card-section",[s("div",{staticClass:"text-subtitle1"},[e._v("Payment Details")])]),s("q-separator",{attrs:{inset:""}}),s("q-card-section",[s("div",{staticClass:"row q-col-gutter-md"},[s("div",{staticClass:"col-6 justify-center column"},[s("div",{staticClass:"text text-right"},[e._v("Paid Amount")])]),s("div",{staticClass:"col-6"},[s("q-input",{ref:"paid_amount",staticClass:"input-right",attrs:{outlined:"",square:"",dense:"",disable:e.selected.length>0,rules:[function(e){return!!e||"Required"},function(e){return parseFloat(e)>=0||"Invalid"}]},on:{focus:function(t){return e.$refs.paid_amount.select()}},model:{value:e.paid_amount,callback:function(t){e.paid_amount=t},expression:"paid_amount"}})],1)]),s("div",{staticClass:"row q-col-gutter-md q-mt-sm"},[s("div",{staticClass:"col-6"},[s("div",{staticClass:"text text-right"},[e._v(e._s(e.computedText))])]),s("div",{staticClass:"col-6"},[s("div",{class:e.cbalance<0?"text text-right q-pr-sm text-green":"text text-right q-pr-sm text-red"},[e._v(e._s(Math.abs(e.cbalance).toFixed(2)))])])]),parseFloat(e.cbalance)<0?s("div",{staticClass:"row q-col-gutter-md q-mt-sm"},[s("div",{staticClass:"col-6 justify-center column"},[s("div",{staticClass:"text text-right"},[e._v("Settle using prepaid amount ?")])]),s("div",{staticClass:"col-6"},[s("q-checkbox",{model:{value:e.settle_using_cbalance,callback:function(t){e.settle_using_cbalance=t},expression:"settle_using_cbalance"}})],1)]):e._e(),s("div",{staticClass:"row q-col-gutter-md q-mt-sm"},[s("div",{staticClass:"col-6"},[s("div",{staticClass:"text text-right"},[e._v("Remaining Amount")])]),s("div",{staticClass:"col-6"},[s("div",{staticClass:"text text-right q-pr-sm"},[e._v(e._s(e.remain_amount.toFixed(2)))])])]),parseFloat(this.paid_amount)>0?s("div",{staticClass:"text-subtitle2"},[e._v("Payment Via")]):e._e(),parseFloat(this.paid_amount)>0?s("div",{staticClass:"row q-col-gutter-sm"},[s("q-radio",{attrs:{val:"cash",label:"Cash"},model:{value:e.payment_via,callback:function(t){e.payment_via=t},expression:"payment_via"}}),s("q-radio",{attrs:{val:"bank",label:"Bank"},model:{value:e.payment_via,callback:function(t){e.payment_via=t},expression:"payment_via"}}),s("q-radio",{attrs:{val:"cheque",label:"Cheque"},model:{value:e.payment_via,callback:function(t){e.payment_via=t},expression:"payment_via"}}),s("q-radio",{attrs:{val:"upi",label:"UPI"},model:{value:e.payment_via,callback:function(t){e.payment_via=t},expression:"payment_via"}}),s("q-radio",{attrs:{val:"card",label:"Card"},model:{value:e.payment_via,callback:function(t){e.payment_via=t},expression:"payment_via"}})],1):e._e(),e.unsettledOrders.length>0?s("div",{staticClass:"row justify-center q-mb-md"},[s("q-table",{attrs:{separator:"cell","rows-per-page-options":[0],"hide-bottom":"",selection:"multiple",selected:e.selected,"row-key":"id",columns:[{label:"Serial No.",name:"serial_no",field:"serial_no",align:"left"},{label:"Invoiced At",name:"invoiced_at",field:"invoiced_at",align:"right"},{label:"Balance",name:"balance",field:"balance",align:"right"},{label:"Settle By",name:"settle_by",field:"settle_by",align:"right"}],data:e.unsettledOrders,title:"Unsettled Orders"},on:{"update:selected":function(t){e.selected=t},selection:e.onSelection},scopedSlots:e._u([{key:"body",fn:function(t){return[s("q-tr",{class:t.row.serial_no===e.serial_no?"bg-green text-white":"",attrs:{props:t}},[s("q-td",[s("q-checkbox",{attrs:{color:"accent",disable:!t.selected&&0===e.remain_amount},model:{value:t.selected,callback:function(s){e.$set(t,"selected",s)},expression:"props.selected"}})],1),s("q-td",[e._v("\n              "+e._s(t.row.serial_no)+"\n            ")]),s("q-td",[e._v("\n              "+e._s(e.getLocaleString(t.row.invoiced_at))+"\n            ")]),s("q-td",[e._v("\n              "+e._s(t.row.balance)+"\n            ")]),s("q-td",[e._v("\n              "+e._s(t.row.settle_by)+"\n            ")])],1)]}},{key:"header-selection",fn:function(){},proxy:!0}],null,!1,3517097034)})],1):e._e(),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{outlined:"",square:"",dense:"",label:"Reference ID",rows:"1",type:"textarea"},model:{value:e.reference_id,callback:function(t){e.reference_id=t},expression:"reference_id"}})],1)]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("div",{staticClass:"text-subtitle2"},[e._v("Remarks")]),s("q-editor",{attrs:{"min-height":"3rem"},model:{value:e.remarks,callback:function(t){e.remarks=t},expression:"remarks"}})],1)])]),s("q-card-actions",[s("q-btn",{attrs:{color:"primary",label:"Submit"},on:{click:e.submit}}),s("q-btn",{attrs:{flat:"",color:"grey-10",label:"cancel"},on:{click:function(t){return e.$emit("close")}}})],1)],1)},a=[],n=(s("e6cf"),s("a79d"),s("ddb0"),{data(){return{paid_amount:null,settle_using_cbalance:!1,payment_via:null,reference_id:null,remarks:"",cbalance:null,unsettledOrders:[],selected:[]}},computed:{computedText(){return parseFloat(this.cbalance)<0?"Prepaid Amount":"Customer Balance"},remain_amount(){let e=0;e=this.settle_using_cbalance&&parseFloat(this.cbalance)<0?Math.abs(parseFloat(this.cbalance))+parseFloat(this.paid_amount):parseFloat(this.paid_amount);const t=parseFloat(this.$_.sumBy(this.selected,(e=>parseFloat(e.balance))));return t>e?0:e-t}},props:["customer","status","total","id","route","serial_no"],mounted(){"Invoice Pending"===this.status?this.paid_amount=this.total:this.paid_amount=0,this.$q.loading.show(),this.$axios.get("customers/balance/"+this.customer.id).then((e=>{this.cbalance=e.data.toFixed(2),e.data>0&&this.$axios.get("customers/sale_orders/unsettled/"+this.customer.id).then((e=>{this.unsettledOrders=e.data,this.unsettledOrders.forEach(((e,t)=>{this.unsettledOrders[t].balance=parseFloat(e.balance_amount).toFixed(2)}))})).finally((()=>{if("Invoice Pending"===this.status){const e={id:this.id,serial_no:this.serial_no,balance:this.total};this.unsettledOrders.push(e)}}))})).finally((()=>{if(0===this.unsettledOrders.length){const e={id:this.id,serial_no:this.serial_no,balance:this.total};this.unsettledOrders.push(e)}this.$q.loading.hide()}))},watch:{},methods:{onSelection({rows:e,keys:t,added:s,evt:i}){if(!0===s){const s=this.$_.findIndex(this.unsettledOrders,["id",t[0]]);this.unsettledOrders[s].settle_by=parseFloat(this.remain_amount)>parseFloat(e[0].balance)?e[0].balance:parseFloat(this.remain_amount).toFixed(2)}else{let e=this.$_.findIndex(this.unsettledOrders,["id",t[0]]);this.unsettledOrders[e].settle_by=null,e=this.$_.findIndex(this.selected,["id",t[0]]),this.selected[e].settle_by=null}},submit(){this.paid_amount>0&&!this.payment_via?this.$q.notify({message:"Payment Via Not Specified",type:"negative"}):parseFloat(this.remain_amount)>0&&this.selected.length!==this.unsettledOrders.length?this.$q.notify({message:"There are sale orders need to be settled",type:"negative"}):(this.$q.loading.show(),this.$axios.post("sale_orders/"+this.route+"/"+this.id,{items:this.selected,payment_via:this.payment_via,reference_id:this.reference_id,remarks:this.remarks,paid_amount:this.paid_amount,remain_amount:this.remain_amount,settle_using_cbalance:this.settle_using_cbalance}).then((e=>{this.$emit("close")})).finally((()=>{this.$q.loading.hide()})))}}}),l=n,r=s("2877"),o=s("f09f"),d=s("a370"),c=s("eb85"),u=s("27f9"),p=s("8f8e"),h=s("3786"),g=s("eaac"),_=s("bd08"),m=s("db86"),b=s("d66b"),f=s("4b7e"),v=s("9c40"),y=s("eebe"),q=s.n(y),x=Object(r["a"])(l,i,a,!1,null,null,null);t["a"]=x.exports;q()(x,"components",{QCard:o["a"],QCardSection:d["a"],QSeparator:c["a"],QInput:u["a"],QCheckbox:p["a"],QRadio:h["a"],QTable:g["a"],QTr:_["a"],QTd:m["a"],QEditor:b["a"],QCardActions:f["a"],QBtn:v["a"]})},b6c6:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"q-pa-md q-gutter-sm"},[s("q-breadcrumbs",[e._l(e.breadcrumbs,(function(e){return[s("q-breadcrumbs-el",{key:e.label,attrs:{to:e.link,label:e.label,disabled:!!e.disabled}})]}))],2)],1)},a=[],n={props:{breadcrumbs:{type:Array,required:!0}},data(){return{}}},l=n,r=s("2877"),o=s("ead5"),d=s("079e"),c=s("eebe"),u=s.n(c),p=Object(r["a"])(l,i,a,!1,null,null,null);t["a"]=p.exports;u()(p,"components",{QBreadcrumbs:o["a"],QBreadcrumbsEl:d["a"]})},fde3:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{class:e.$q.screen.gt.sm?"q-px-lg":"q-px-xs"},[s("q-card",[s("q-card-section",[s("q-table",{attrs:{title:"Users",data:e.items,columns:e.columns,"row-key":e.rowKey,dense:e.$q.screen.lt.md,"visible-columns":e.visibleColumns,filter:e.search,loading:e.loading,"rows-per-page-options":e.infiniteRows?[0]:[25,50,100],pagination:e.pagination},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"loading",fn:function(){return[s("q-inner-loading",{attrs:{showing:""}},[s("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1)]},proxy:!0},{key:"top",fn:function(t){return[s("div",{staticClass:"col"},[s("q-input",{attrs:{dense:"",debounce:"300",placeholder:"Search here..",square:"",clearable:""},scopedSlots:e._u([{key:"append",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!0),model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),s("q-space"),s("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"visibility"},on:{click:function(t){e.filterDrawer=!e.filterDrawer}}}),s("q-btn",{staticClass:"q-ml-md",attrs:{flat:"",round:"",dense:"",icon:t.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:t.toggleFullscreen}})]}},{key:"body-cell-actions",fn:function(t){return[s("q-td",{attrs:{props:t}},[!e.canEdit||t.row.hasOwnProperty("status")&&"draft"!=t.row.status?e._e():s("q-btn",{attrs:{round:"",icon:"edit",flat:"",color:"black",to:e.pageEdit?void 0:e.editRoute?e.editRoute+"/edit/"+t.row.id:e.route+"/edit/"+t.row.id},on:{click:function(s){return e.$emit("edit-fn",t.row)}}}),e.canDelete?s("q-btn",{attrs:{round:"",icon:"delete",flat:"",color:"black"},on:{click:function(s){return e.deleteFn(t.row.id)}}}):e._e()],1)]}},{key:"body-cell",fn:function(t){return[t.col.name==e.link_key?s("q-td",{class:"right"==t.col.align?"text-right":"text-left",attrs:{props:t}},[s("router-link",{staticClass:"text-ble-9u",staticStyle:{"text-decoration":"none","font-weight":"700"},attrs:{to:e.route+"/view/"+t.row.id}},[e._v("\n                          "+e._s(t.value)+"\n                        ")]),s("q-btn",{attrs:{icon:"content_copy",flat:"",round:""},on:{click:function(s){return e.$store.dispatch("copyToClipboard",t.row.name)}}})],1):s("q-td",{class:"right"==t.col.align?"text-right":"text-left"},["datetime"==t.col.field_type?[e._v("\n                            "+e._s(e.getLocaleString(t.value))+"\n                        ")]:[e._v("\n                            "+e._s(t.value)+"\n                        ")]],2)]}}])})],1)],1)],1),s("q-drawer",{attrs:{side:"right",breakpoint:700,bordered:"",overlay:"",behavior:"mobile"},model:{value:e.filterDrawer,callback:function(t){e.filterDrawer=t},expression:"filterDrawer"}},[s("q-list",[s("q-item-label",{attrs:{header:""}},[e._v("Visible Columns")]),e._l(e.columns,(function(t,i){return[1!=t.required?s("q-item",{key:i},[s("q-item-section",[s("q-toggle",{attrs:{val:t.field,label:t.label},on:{input:e.changeVisibleColumns},model:{value:e.visibleColumns,callback:function(t){e.visibleColumns=t},expression:"visibleColumns"}})],1)],1):e._e()]}))],2)],1)],1)},a=[],n=(s("e6cf"),s("a79d"),{props:{infiniteRows:{type:Boolean,default:!1},rowKey:{type:String,default:"name"},route:{type:String,required:!0},pagePreferences:{type:Object,required:!0},editPermission:{type:String,default:""},deletePermission:{type:String,default:""},pageEdit:{type:Boolean,default:!1},editRoute:{type:String,default:null},deleteRoute:{type:String,default:null}},data(){return{link_key:null,search:null,filterDrawer:!1,items:[],visibleColumns:[],columns:[],loading:!1,canEdit:!1,canDelete:!1,pagination:null}},watch:{pagination:{handler(e,t){},deep:!0}},mounted(){this.getDataFromApi()},methods:{changeVisibleColumns(){},deleteFn(e){this.$q.dialog({title:"Confirm",message:"Would you like to delete this record?",cancel:!0,persistent:!0}).onOk((()=>{this.$q.loading.show();const t=this.deleteRoute?this.deleteRoute+"/"+e:this.route+"/"+e;this.$axios.post(t,{_method:"DELETE"}).then((e=>{"success"===e.data.message&&this.$q.notify({type:"info",message:"Record deleted from database"})})).finally((()=>{this.$q.loading.hide(),this.getDataFromApi()}))})).onCancel((()=>{}))},getDataFromApi(){this.loading=!0,this.$axios.get(this.route).then((e=>{this.items=e.data.model,this.visibleColumns=e.data.visible_columns,e.data.pagination&&(this.pagination=e.data.pagination),this.columns=e.data.columns,this.canEdit=this.$store.getters.hasPermissionTo(this.editPermission),this.canDelete=this.$store.getters.hasPermissionTo(this.deletePermission),(this.canEdit||this.canDelete)&&this.columns.push({name:"actions",label:"Actions",field:"actions",required:!0,sortable:!1,align:"right"}),this.link_key=e.data.link_key})).finally((()=>{this.loading=!1}))},getLocaleString(e){if(e){const t=new Date(e);return t.toLocaleString("en-IN")}return null}}}),l=n,r=s("2877"),o=s("f09f"),d=s("a370"),c=s("eaac"),u=s("74f7"),p=s("cf57"),h=s("27f9"),g=s("0016"),_=s("2c91"),m=s("9c40"),b=s("db86"),f=s("9404"),v=s("1c1c"),y=s("0170"),q=s("66e5"),x=s("4074"),C=s("9564"),k=s("eebe"),$=s.n(k),w=Object(r["a"])(l,i,a,!1,null,null,null);t["a"]=w.exports;$()(w,"components",{QCard:o["a"],QCardSection:d["a"],QTable:c["a"],QInnerLoading:u["a"],QSpinnerGears:p["a"],QInput:h["a"],QIcon:g["a"],QSpace:_["a"],QBtn:m["a"],QTd:b["a"],QDrawer:f["a"],QList:v["a"],QItemLabel:y["a"],QItem:q["a"],QItemSection:x["a"],QToggle:C["a"]})}}]);